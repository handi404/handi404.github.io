

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Han Di">
  <meta name="keywords" content="">
  
    <meta name="description" content="一、Mybatis 概述 1、什么是MyBatis? MyBatis（官网：https:&#x2F;&#x2F;mybatis.org&#x2F;mybatis-3&#x2F;zh&#x2F;index.html ）是一款优秀的 持久层 框架，用于简化[JDBC]的开发。是 Apache的一个[开源]项目iBatis，2010年这个项目由apache迁移到了google code，并且改名为MyBatis 。2013年11月迁移到Github。">
<meta property="og:type" content="article">
<meta property="og:title" content="繁星的蓝">
<meta property="og:url" content="http://example.com/2025/06/24/Java/Framework/Spring%20Boot/Data/MyBatis/mybatis%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/index.html">
<meta property="og:site_name" content="繁星的蓝">
<meta property="og:description" content="一、Mybatis 概述 1、什么是MyBatis? MyBatis（官网：https:&#x2F;&#x2F;mybatis.org&#x2F;mybatis-3&#x2F;zh&#x2F;index.html ）是一款优秀的 持久层 框架，用于简化[JDBC]的开发。是 Apache的一个[开源]项目iBatis，2010年这个项目由apache迁移到了google code，并且改名为MyBatis 。2013年11月迁移到Github。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/7fdc1908817ad91580808f0f58491608.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/ac9313736a49f81ebebb3d11abeb8747.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/11fcc66fe7731be57c48c0944082b62c.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/5a8647b0bc99f18e949c9d0f21570c14.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/8956be673db241109d1bb99ee61d1de7.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/de544208e4128781fdd03575f6ca3a20.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/de36a341ff9be66139dcf86833ae99a1.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/ec00c417cb27b2be4c061bc6bf56465b.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/48eed8f46fa69f08769433f1d5477d53.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/db6ab2df5219e27819c4225b89f3cfbf.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/476e0a41a19fed2710f8bd7cce07fbde.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/267706ec68a1a9df11b3e5d7bae8ca49.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/8e4ab8204948adf945f56bd2add2f495.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/edec5b560d411f0f569bdb5b996e78ca.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/39efd9761fb2368f9a87693cd6a00c09.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/f17dac5ef160d7b240869e200ac3d886.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/5e6578848209ed1e092e912386ad1fc1.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/83ba80007b3ebe80b2a1f15d800873ee.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/015479a563eee78804640b522ff63393.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/f9e5da8b61d10ef97e250886b4f34acf.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/abb13ee04ec9c6a56045b958ebe5f1cb.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/941afe187f55439f106b6a83f28dd084.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/889e95449834aa31ea3be88e48b2ddb7.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/37c9711cc284c15da2e22b5fdd1751b2.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/7f5ea4fefe1b5a975492509072dd2f91.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/39671172995ca83468310f358e40d22f.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/6b5a21ec8c402c01c427a6f2bf657371.png">
<meta property="article:published_time" content="2025-06-24T13:34:27.082Z">
<meta property="article:modified_time" content="2024-11-29T06:31:56.262Z">
<meta property="article:author" content="Han Di">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i-blog.csdnimg.cn/blog_migrate/7fdc1908817ad91580808f0f58491608.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>繁星的蓝</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/macpanel.css">
<link rel="stylesheet" href="/css/scrollAnimation.css">
<link rel="stylesheet" href="/css/glassBg.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body><!-- hexo injector body_begin start --><div id="web_bg"></div><!-- hexo injector body_begin end -->
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>HAN&#39;S BLOG</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/post.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text=""></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-06-24 21:34" pubdate>
          2025年6月24日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          6.6k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          56 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header"></h1>
            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    本文最后更新于 2024年11月29日 下午
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <h2 id="一、Mybatis">一、Mybatis</h2>
<h3 id="概述">概述</h3>
<p>1、什么是MyBatis?</p>
<p>MyBatis（官网：<a target="_blank" rel="noopener" href="https://mybatis.org/mybatis-3/zh/index.html" title="https://mybatis.org/mybatis-3/zh/index.html">https://mybatis.org/mybatis-3/zh/index.html</a> ）是一款优秀的 <strong>持久层</strong> <strong>框架</strong>，用于简化[JDBC]的开发。是 Apache的一个[开源]项目iBatis，2010年这个项目由apache迁移到了google code，并且改名为MyBatis 。2013年11月迁移到Github。</p>
<blockquote>
<p>MyBatis 免除了几乎所有的 JDBC 代码以及设置参数和获取结果集的工作。</p>
<p>MyBatis 可以通过简单的 XML 或注解来配置和映射原始类型、接口和 Java POJO（Plain Old Java Objects，普通老式 Java 对象）为数据库中的记录。</p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%8C%81%E4%B9%85%E5%B1%82&amp;spm=1001.2101.3001.7020">持久层</a>：指的是就是数据访问层(dao)，是用来操作数据库的。</p>
</blockquote>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/7fdc1908817ad91580808f0f58491608.png" srcset="/img/loading.gif" lazyload alt=""></p>
<blockquote>
<p>框架：是一个半成品软件，是一套可重用的、通用的、软件基础代码模型。在框架的基础上进行软件开发更加高效、规范、通用、可拓展。</p>
</blockquote>
<h2 id="二、快速入门">二、快速入门</h2>
<h3 id="准备工作">准备工作</h3>
<h4 id="1、创建springboot工程">1、创建springboot工程</h4>
<p>创建springboot工程；</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/ac9313736a49f81ebebb3d11abeb8747.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>导入 mybatis的起步依赖、mysql的驱动包（初次使用，下载依赖时间会有些长，不要着急；如果下载好依然无法打开，请重启Idea）</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/11fcc66fe7731be57c48c0944082b62c.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>项目创建完成后，会自动在pom.xml文件中，导入 <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=Mybatis%E4%BE%9D%E8%B5%96&amp;spm=1001.2101.3001.7020">Mybatis依赖</a>和 MySQL驱动依赖。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h4 id="2、数据准备">2、数据准备</h4>
<p>创建用户表user，并创建对应的实体类User。</p>
<p>用户表：</p>
<blockquote>
<p>-- 用户表<br>
create table user(<br>
    id int unsigned primary key auto_increment comment ‘ID’,<br>
    name varchar(100) comment ‘姓名’,<br>
    age tinyint unsigned comment ‘年龄’,<br>
    gender tinyint unsigned comment ‘性别, 1:男, 2:女’,<br>
    phone varchar(11) comment ‘手机号’<br>
) comment ‘用户表’;</p>
</blockquote>
<p>添加测试数据：</p>
<blockquote>
<p>insert into user(id, name, age, gender, phone) VALUES (null,‘白眉鹰王’,55,‘1’,‘18800000000’);<br>
insert into user(id, name, age, gender, phone) VALUES (null,‘金毛狮王’,45,‘1’,‘18800000001’);<br>
insert into user(id, name, age, gender, phone) VALUES (null,‘青翼蝠王’,38,‘1’,‘18800000002’);<br>
insert into user(id, name, age, gender, phone) VALUES (null,‘紫衫龙王’,42,‘2’,‘18800000003’);<br>
insert into user(id, name, age, gender, phone) VALUES (null,‘光明左使’,37,‘1’,‘18800000004’);<br>
insert into user(id, name, age, gender, phone) VALUES (null,‘光明右使’,48,‘1’,‘18800000005’);</p>
</blockquote>
<p>查询数据：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/5a8647b0bc99f18e949c9d0f21570c14.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>创建实体类：</p>
<blockquote>
<p>public class User {<br>
    private Integer id;   //id（主键）<br>
    private String name;  //姓名<br>
    private Short age;    //年龄<br>
    private Short gender; //性别<br>
    private String phone; //手机号</p>
<p>//省略GET, SET方法<br>
}</p>
</blockquote>
<h3 id="配置Mybatis">配置Mybatis</h3>
<p>在之前使用图形化客户端工具，连接MySQL数据库时，需要配置：</p>
<p>连接数据库的四大参数：</p>
<ul>
<li>
<p>MySQL驱动类</p>
</li>
<li>
<p>登录名</p>
</li>
<li>
<p>密码</p>
</li>
<li>
<p>数据库连接字符串</p>
</li>
</ul>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/8956be673db241109d1bb99ee61d1de7.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>在springboot项目中，可以编写application.properties文件，配置数据库连接信息。我们要连接数据库，就需要配置数据库连接的基本信息，包括：driver-class-name、url 、username，password。 在入门程序中，大家可以直接这么配置，后面会介绍什么是驱动。</p>
<p>打开resources下的application.properties</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/de544208e4128781fdd03575f6ca3a20.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>然后进行配置；</p>
<blockquote>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">spring<span class="hljs-selector-class">.datasource</span>.driver-class-name=com<span class="hljs-selector-class">.mysql</span><span class="hljs-selector-class">.cj</span><span class="hljs-selector-class">.jdbc</span><span class="hljs-selector-class">.Driver</span><br>spring<span class="hljs-selector-class">.datasource</span>.url=jdbc:mysql:<span class="hljs-comment">//localhost:3306/mybatis</span><br>spring<span class="hljs-selector-class">.datasource</span>.username=root<br>spring<span class="hljs-selector-class">.datasource</span>.password=<span class="hljs-number">1234</span><br></code></pre></td></tr></table></figure>
</blockquote>
<h3 id="编写SQL语句">编写SQL语句</h3>
<p>在创建出来的springboot工程中，在引导类所在包下，在创建一个包 mapper。在mapper包下创建一个接口 UserMapper ，这是一个持久层接口（Mybatis的持久层接口规范一般都叫 XxxMapper）。</p>
<p>UserMapper：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.itheima.pojo.User;<br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Select;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> &#123;<br><br>    <span class="hljs-comment">//查询所有用户数据</span><br>    <span class="hljs-meta">@Select(&quot;select id, name, age, gender, phone from user&quot;)</span><br>    <span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">list</span><span class="hljs-params">()</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>@Mapper注解：表示是mybatis中的Mapper接口</p>
<ul>
<li>程序运行时：框架会自动生成接口的实现类对象(代理对象)，并给交Spring的IOC容器管理</li>
</ul>
<p>@Select注解：代表的就是select查询，用于书写select查询语句</p>
</blockquote>
<h3 id="单元测试">单元测试</h3>
<p>在创建出来的SpringBoot工程中，在src下的test目录下，已经自动帮我们创建好了测试类 ，并且在测试类上已经添加了注解 @SpringBootTest，代表该测试类已经与SpringBoot整合。</p>
<p>该测试类在运行时，会自动通过引导类加载Spring的环境（IOC容器）。我们要测试那个bean对象，就可以直接通过@Autowired注解直接将其注入进行，然后就可以测试了。</p>
<p>测试类代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs undefined">@SpringBootTest<br>public class MybatisQuickstartApplicationTests &#123;<br><br>    @Autowired<br>    private UserMapper userMapper;<br><br>    @Test<br>    public void testList()&#123;<br>        List&lt;User&gt; userList = userMapper.list();<br>        for (User user : userList) &#123;<br>            System.out.println(user);<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<p>运行结果：</p>
<blockquote>
<p>User{id=1, name=‘白眉鹰王’, age=55, gender=1, phone=‘18800000000’}<br>
User{id=2, name=‘金毛狮王’, age=45, gender=1, phone=‘18800000001’}<br>
User{id=3, name=‘青翼蝠王’, age=38, gender=1, phone=‘18800000002’}<br>
User{id=4, name=‘紫衫龙王’, age=42, gender=2, phone=‘18800000003’}<br>
User{id=5, name=‘光明左使’, age=37, gender=1, phone=‘18800000004’}<br>
User{id=6, name=‘光明右使’, age=48, gender=1, phone=‘18800000005’}</p>
</blockquote>
<h3 id="打开SQL提示和警告">打开SQL提示和警告</h3>
<p>默认我们在UserMapper接口上加的@Select注解中编写SQL语句是没有提示的。 如果想让idea给我们提示对应的SQL语句，我们需要在IDEA中配置与MySQL数据库的链接。 默认我们在UserMapper接口上的@Select注解中编写SQL语句是没有提示的。如果想让idea给出提示，可以做如下配置：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/de36a341ff9be66139dcf86833ae99a1.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>配置完成之后，发现SQL语句中的关键字有提示了.</p>
<h2 id="三、基础操作（案例）">三、基础操作（案例）</h2>
<h3 id="1、准备工作">1、准备工作</h3>
<p>实施前的准备工作：</p>
<ol>
<li>
<p>准备数据库表</p>
</li>
<li>
<p>创建一个新的springboot工程，选择引入对应的起步依赖（mybatis、mysql驱动、lombok）</p>
</li>
<li>
<p>application.properties中引入数据库连接信息</p>
</li>
<li>
<p>创建对应的实体类 Emp（实体类属性采用驼峰命名）</p>
</li>
<li>
<p>准备Mapper接口 EmpMapper</p>
</li>
</ol>
<p><strong>准备数据库表</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 部门管理</span><br><span class="hljs-keyword">create table</span> dept<br>(<br>    id          <span class="hljs-type">int</span> unsigned <span class="hljs-keyword">primary key</span> auto_increment comment <span class="hljs-string">&#x27;主键ID&#x27;</span>,<br>    name        <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">not null</span> <span class="hljs-keyword">unique</span> comment <span class="hljs-string">&#x27;部门名称&#x27;</span>,<br>    create_time datetime    <span class="hljs-keyword">not null</span> comment <span class="hljs-string">&#x27;创建时间&#x27;</span>,<br>    update_time datetime    <span class="hljs-keyword">not null</span> comment <span class="hljs-string">&#x27;修改时间&#x27;</span><br>) comment <span class="hljs-string">&#x27;部门表&#x27;</span>;<br><span class="hljs-comment">-- 部门表测试数据</span><br><span class="hljs-keyword">insert into</span> dept (id, name, create_time, update_time)<br><span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;学工部&#x27;</span>, now(), now()),<br>       (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;教研部&#x27;</span>, now(), now()),<br>       (<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;咨询部&#x27;</span>, now(), now()),<br>       (<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;就业部&#x27;</span>, now(), now()),<br>       (<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;人事部&#x27;</span>, now(), now());<br><br><br><span class="hljs-comment">-- 员工管理</span><br><span class="hljs-keyword">create table</span> emp<br>(<br>    id          <span class="hljs-type">int</span> unsigned <span class="hljs-keyword">primary key</span> auto_increment comment <span class="hljs-string">&#x27;ID&#x27;</span>,<br>    username    <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>)      <span class="hljs-keyword">not null</span> <span class="hljs-keyword">unique</span> comment <span class="hljs-string">&#x27;用户名&#x27;</span>,<br>    password    <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">default</span> <span class="hljs-string">&#x27;123456&#x27;</span> comment <span class="hljs-string">&#x27;密码&#x27;</span>,<br>    name        <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>)      <span class="hljs-keyword">not null</span> comment <span class="hljs-string">&#x27;姓名&#x27;</span>,<br>    gender      tinyint unsigned <span class="hljs-keyword">not null</span> comment <span class="hljs-string">&#x27;性别, 说明: 1 男, 2 女&#x27;</span>,<br>    image       <span class="hljs-type">varchar</span>(<span class="hljs-number">300</span>) comment <span class="hljs-string">&#x27;图像&#x27;</span>,<br>    job         tinyint unsigned comment <span class="hljs-string">&#x27;职位, 说明: 1 班主任,2 讲师, 3 学工主管, 4 教研主管, 5 咨询师&#x27;</span>,<br>    entrydate   <span class="hljs-type">date</span> comment <span class="hljs-string">&#x27;入职时间&#x27;</span>,<br>    dept_id     <span class="hljs-type">int</span> unsigned comment <span class="hljs-string">&#x27;部门ID&#x27;</span>,<br>    create_time datetime         <span class="hljs-keyword">not null</span> comment <span class="hljs-string">&#x27;创建时间&#x27;</span>,<br>    update_time datetime         <span class="hljs-keyword">not null</span> comment <span class="hljs-string">&#x27;修改时间&#x27;</span><br>) comment <span class="hljs-string">&#x27;员工表&#x27;</span>;<br><span class="hljs-comment">-- 员工表测试数据</span><br><span class="hljs-keyword">INSERT INTO</span> emp (id, username, password, name, gender, image, job, entrydate, dept_id, create_time, update_time)<br><span class="hljs-keyword">VALUES</span> <br>(<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;jinyong&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;金庸&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;1.jpg&#x27;</span>, <span class="hljs-number">4</span>, <span class="hljs-string">&#x27;2000-01-01&#x27;</span>, <span class="hljs-number">2</span>, now(), now()),<br>(<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;zhangwuji&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;张无忌&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;2.jpg&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;2015-01-01&#x27;</span>, <span class="hljs-number">2</span>, now(), now()),<br>(<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;yangxiao&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;杨逍&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;3.jpg&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;2008-05-01&#x27;</span>, <span class="hljs-number">2</span>, now(), now()),<br>(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;weiyixiao&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;韦一笑&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;4.jpg&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;2007-01-01&#x27;</span>, <span class="hljs-number">2</span>, now(), now()),<br>(<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;changyuchun&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;常遇春&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;5.jpg&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;2012-12-05&#x27;</span>, <span class="hljs-number">2</span>, now(), now()),<br>(<span class="hljs-number">6</span>, <span class="hljs-string">&#x27;xiaozhao&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;小昭&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;6.jpg&#x27;</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;2013-09-05&#x27;</span>, <span class="hljs-number">1</span>, now(), now()),<br>(<span class="hljs-number">7</span>, <span class="hljs-string">&#x27;jixiaofu&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;纪晓芙&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;7.jpg&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;2005-08-01&#x27;</span>, <span class="hljs-number">1</span>, now(), now()),<br>(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;zhouzhiruo&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;周芷若&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;8.jpg&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;2014-11-09&#x27;</span>, <span class="hljs-number">1</span>, now(), now()),<br>(<span class="hljs-number">9</span>, <span class="hljs-string">&#x27;dingminjun&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;丁敏君&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;9.jpg&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;2011-03-11&#x27;</span>, <span class="hljs-number">1</span>, now(), now()),<br>(<span class="hljs-number">10</span>, <span class="hljs-string">&#x27;zhaomin&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;赵敏&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;10.jpg&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;2013-09-05&#x27;</span>, <span class="hljs-number">1</span>, now(), now()),<br>(<span class="hljs-number">11</span>, <span class="hljs-string">&#x27;luzhangke&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;鹿杖客&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;11.jpg&#x27;</span>, <span class="hljs-number">5</span>, <span class="hljs-string">&#x27;2007-02-01&#x27;</span>, <span class="hljs-number">3</span>, now(), now()),<br>(<span class="hljs-number">12</span>, <span class="hljs-string">&#x27;hebiweng&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;鹤笔翁&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;12.jpg&#x27;</span>, <span class="hljs-number">5</span>, <span class="hljs-string">&#x27;2008-08-18&#x27;</span>, <span class="hljs-number">3</span>, now(), now()),<br>(<span class="hljs-number">13</span>, <span class="hljs-string">&#x27;fangdongbai&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;方东白&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;13.jpg&#x27;</span>, <span class="hljs-number">5</span>, <span class="hljs-string">&#x27;2012-11-01&#x27;</span>, <span class="hljs-number">3</span>, now(), now()),<br>(<span class="hljs-number">14</span>, <span class="hljs-string">&#x27;zhangsanfeng&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;张三丰&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;14.jpg&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;2002-08-01&#x27;</span>, <span class="hljs-number">2</span>, now(), now()),<br>(<span class="hljs-number">15</span>, <span class="hljs-string">&#x27;yulianzhou&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;俞莲舟&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;15.jpg&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;2011-05-01&#x27;</span>, <span class="hljs-number">2</span>, now(), now()),<br>(<span class="hljs-number">16</span>, <span class="hljs-string">&#x27;songyuanqiao&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;宋远桥&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;16.jpg&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;2010-01-01&#x27;</span>, <span class="hljs-number">2</span>, now(), now()),<br>(<span class="hljs-number">17</span>, <span class="hljs-string">&#x27;chenyouliang&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>, <span class="hljs-string">&#x27;陈友谅&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;17.jpg&#x27;</span>, <span class="hljs-keyword">NULL</span>, <span class="hljs-string">&#x27;2015-03-21&#x27;</span>, <span class="hljs-keyword">NULL</span>, now(), now());<br></code></pre></td></tr></table></figure>
<p><strong>创建一个新的springboot工程，选择引入对应的起步依赖（mybatis、mysql驱动、lombok）</strong></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/ec00c417cb27b2be4c061bc6bf56465b.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><strong>application.properties中引入数据库连接信息</strong> ：</p>
<blockquote>
<p>#驱动类名称<br>
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver<br>
#数据库连接的url<br>
spring.datasource.url=jdbc:mysql://localhost:3306/mybatis<br>
#连接数据库的用户名<br>
spring.datasource.username=root<br>
#连接数据库的密码<br>
spring.datasource.password=1234</p>
</blockquote>
<p><strong>创建对应的实体类Emp（实体类属性采用驼峰命名）</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs undefined">@Data<br><br>@NoArgsConstructor<br><br>@AllArgsConstructor<br><br>public class Emp &#123;<br><br>    private Integer id;<br><br>    private String username;<br><br>    private String password;<br><br>    private String name;<br><br>    private Short gender;<br><br>    private String image;<br><br>    private Short job;<br><br>    private LocalDate entrydate;     //LocalDate类型对应数据表中的date类型<br><br>    private Integer deptId;<br><br>    private LocalDateTime createTime;//LocalDateTime类型对应数据表中的datetime类型<br><br>    private LocalDateTime updateTime;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>**@Data 注解：为类中的属性提供get方法，set方法和tostring方法</p>
<p>**@NoArgsConstructor 注解：提供无参构造</p>
<p>**@AllArgsConstructor 注解：提供全参构造</p>
</blockquote>
<p><strong>准备Mapper接口：EmpMapper</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*@Mapper注解：表示当前接口为mybatis中的Mapper接口</span><br><span class="hljs-comment">程序运行时会自动创建接口的实现类对象(代理对象)，并交给Spring的IOC容器管理</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpMapper</span> &#123;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="2、功能实现">2、功能实现</h3>
<h4 id="2-1-删除">2.1 删除</h4>
<p><strong>功能：根据主键删除数据</strong></p>
<p><em>SQL语句</em></p>
<blockquote>
<p>-- 删除id=17的数据<br>
delete from emp where id = 1;</p>
</blockquote>
<p><em>接口方法</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpMapper</span> &#123;<br><br>    <span class="hljs-comment">// 根据id删除数据。</span><br>    <span class="hljs-meta">@Delete(&quot;delete from emp where id = #&#123;id&#125; &quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(Integer id)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>@Delete注解：用于编写delete操作的SQL语句</p>
<p>如果mapper接口方法形参只有一个普通类型的参数，#{…} 里面的属性名可以随便写，如：#{id}、#{value}。但是建议保持名字一致。</p>
</blockquote>
<p><em>测试</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringbootMybatisCrudApplicationTests</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> EmpMapper empMapper;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testDel</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 调用删除方法</span><br>        empMapper.delete(<span class="hljs-number">1</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>运行前：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/48eed8f46fa69f08769433f1d5477d53.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>运行后：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/db6ab2df5219e27819c4225b89f3cfbf.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/476e0a41a19fed2710f8bd7cce07fbde.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h4 id="2-2-预编译SQL">2.2 预编译SQL</h4>
<p>预编译SQL有两个优势：</p>
<blockquote>
<p>性能更高：预编译SQL，编译一次之后会将编译后的SQL语句缓存起来，后面再次执行这条语句时，不会再次编译。（只是输入的参数不同）</p>
<p>更安全(防止SQL注入)：将敏感字进行转义，保障SQL的安全性。</p>
</blockquote>
<p><strong>SQL注入</strong></p>
<p>SQL注入：是通过操作输入的数据来修改事先定义好的SQL语句，以达到执行代码对服务器进行攻击的方法。 由于没有对用户输入进行充分检查，而SQL又是拼接而成，在用户输入参数时，在参数中添加一些SQL关键字，达到改变SQL运行结果的目的，也可以完成恶意攻击。</p>
<p>什么原因导致了改变SQL运行结果？</p>
<p>由于没有对用户输入内容进行充分检查，而SQL又是字符串拼接方式而成，在用户输入参数时，在参数中添加一些SQL关键字，达到改变SQL运行结果的目的，从而完成恶意攻击。</p>
<h5 id="参数占位符">参数占位符</h5>
<p>在Mybatis中提供的参数占位符有两种：${…} 、#{…}</p>
<ul>
<li>
<p>#{…}</p>
<ul>
<li>
<p>执行SQL时，会将#{…}替换为?，生成预编译SQL，会自动设置参数值</p>
</li>
<li>
<p>使用时机：参数传递，都使用#{…}</p>
</li>
</ul>
</li>
<li>
<p>${…}</p>
<ul>
<li>
<p>拼接SQL。直接将参数拼接在SQL语句中，存在SQL注入问题</p>
</li>
<li>
<p>使用时机：如果对表名、列表进行动态设置时使用</p>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>注意事项：在项目开发中，建议使用#{…}，生成预编译SQL，防止SQL注入安全。</p>
</blockquote>
<h4 id="2-3-新增">2.3 新增</h4>
<p>员工表结构：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/267706ec68a1a9df11b3e5d7bae8ca49.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>SQL语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert into</span> emp(username, name, gender, image, job, entrydate, dept_id, create_time, update_time)<br><br><span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;songyuanqiao&#x27;</span>, <span class="hljs-string">&#x27;宋远桥&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;1.jpg&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;2012-10-09&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;2022-10-01 10:00:00&#x27;</span>, <span class="hljs-string">&#x27;2022-10-01 10:00:00&#x27;</span>);<br></code></pre></td></tr></table></figure>
<p>接口方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpMapper</span> &#123;<br><br>    <span class="hljs-comment">// 新增员工的操作</span><br>    <span class="hljs-meta">@Insert(&quot;insert into emp(username, name, gender, image, job, entrydate, dept_id, create_time, update_time)&quot; +</span><br><span class="hljs-meta">            &quot;values (#&#123;username&#125;,#&#123;name&#125;,#&#123;gender&#125;,#&#123;image&#125;,#&#123;job&#125;,#&#123;entrydate&#125;,#&#123;deptId&#125;,#&#123;createTime&#125;,#&#123;updateTime&#125;);&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(Emp emp)</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>测试类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringbootMybatisCrudApplicationTests</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> EmpMapper empMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInsert</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">emp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Emp</span>();<br>        emp.setUsername(<span class="hljs-string">&quot;Tom2&quot;</span>);<br>        emp.setName(<span class="hljs-string">&quot;汤姆2&quot;</span>);<br>        emp.setImage(<span class="hljs-string">&quot;1.jpg&quot;</span>);<br>        emp.setGender((<span class="hljs-type">short</span>)<span class="hljs-number">1</span>);<br>        emp.setJob((<span class="hljs-type">short</span>)<span class="hljs-number">1</span>);<br>        emp.setEntrydate(LocalDate.of(<span class="hljs-number">2000</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>));<br>        emp.setCreateTime(LocalDateTime.now());<br>        emp.setUpdateTime(LocalDateTime.now());<br>        emp.setDeptId(<span class="hljs-number">1</span>);<br>        empMapper.insert(emp);<br><br>        System.out.println(emp.getId());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>日志输出：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/8e4ab8204948adf945f56bd2add2f495.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h4 id="2-4-主键返回">2.4 主键返回</h4>
<p>概念：在数据添加成功后，需要获取插入数据库数据的主键。</p>
<p>那要如何实现在插入数据之后返回所插入行的主键值呢？</p>
<p>默认情况下，执行插入操作时，是不会主键值返回的。如果我们想要拿到主键值，需要在Mapper接口中的方法上添加一个Options注解，并在注解中指定属性useGeneratedKeys=true和keyProperty=“实体类属性名”</p>
<p>主键返回代码实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpMapper</span> &#123;<br>    <span class="hljs-comment">// 新增员工的操作</span><br>    <span class="hljs-meta">@Options(keyProperty = &quot;id&quot;,useGeneratedKeys = true)</span><br>    <span class="hljs-meta">@Insert(&quot;insert into emp(username, name, gender, image, job, entrydate, dept_id, create_time, update_time)&quot; +</span><br><span class="hljs-meta">            &quot;values (#&#123;username&#125;,#&#123;name&#125;,#&#123;gender&#125;,#&#123;image&#125;,#&#123;job&#125;,#&#123;entrydate&#125;,#&#123;deptId&#125;,#&#123;createTime&#125;,#&#123;updateTime&#125;);&quot;)</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>测试：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringbootMybatisCrudApplicationTests</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> EmpMapper empMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInsert</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">emp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Emp</span>();<br>        emp.setUsername(<span class="hljs-string">&quot;Tom2&quot;</span>);<br>        emp.setName(<span class="hljs-string">&quot;汤姆2&quot;</span>);<br>        emp.setImage(<span class="hljs-string">&quot;1.jpg&quot;</span>);<br>        emp.setGender((<span class="hljs-type">short</span>)<span class="hljs-number">1</span>);<br>        emp.setJob((<span class="hljs-type">short</span>)<span class="hljs-number">1</span>);<br>        emp.setEntrydate(LocalDate.of(<span class="hljs-number">2000</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>));<br>        emp.setCreateTime(LocalDateTime.now());<br>        emp.setUpdateTime(LocalDateTime.now());<br>        emp.setDeptId(<span class="hljs-number">1</span>);<br>        empMapper.insert(emp);<br><br>        System.out.println(emp.getId());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>结果如下：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/edec5b560d411f0f569bdb5b996e78ca.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h4 id="2-5-更新">2.5 更新</h4>
<p>功能：修改员工信息</p>
<p>SQL语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 修改员工信息<br><span class="hljs-keyword">update</span> emp<br><span class="hljs-keyword">set</span> username    <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;linghushaoxia&#x27;</span>,<br>    name        <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;令狐少侠&#x27;</span>,<br>    gender      <span class="hljs-operator">=</span> <span class="hljs-number">1</span>,<br>    image       <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;1.jpg&#x27;</span>,<br>    job         <span class="hljs-operator">=</span> <span class="hljs-number">2</span>,<br>    entrydate   <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;2012-01-01&#x27;</span>,<br>    dept_id     <span class="hljs-operator">=</span> <span class="hljs-number">2</span>,<br>    update_time <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;2022-10-01 12:12:12&#x27;</span><br><span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span> <span class="hljs-number">18</span>;<br></code></pre></td></tr></table></figure>
<p>接口方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpMapper</span> &#123;<br>    <span class="hljs-comment">// 更新员工数据</span><br>    <span class="hljs-meta">@Update(&quot;update emp set username=#&#123;username&#125;,name=#&#123;name&#125;,gender=#&#123;gender&#125;,image=#&#123;image&#125;,job=#&#123;job&#125;,&quot; +</span><br><span class="hljs-meta">            &quot;entrydate=#&#123;entrydate&#125;,dept_id=#&#123;deptId&#125;,update_time=#&#123;updateTime&#125; where id=#&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(Emp emp)</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>测试类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringbootMybatisCrudApplicationTests</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> EmpMapper empMapper;<br>    <span class="hljs-comment">//修改员工信息</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testUpdate</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">emp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Emp</span>();<br>        emp.setId(<span class="hljs-number">21</span>);<br>        emp.setUsername(<span class="hljs-string">&quot;Tom3&quot;</span>);<br>        emp.setName(<span class="hljs-string">&quot;汤姆3&quot;</span>);<br>        emp.setImage(<span class="hljs-string">&quot;2.jpg&quot;</span>);<br>        emp.setGender((<span class="hljs-type">short</span>)<span class="hljs-number">1</span>);<br>        emp.setJob((<span class="hljs-type">short</span>)<span class="hljs-number">2</span>);<br>        emp.setEntrydate(LocalDate.of(<span class="hljs-number">2012</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>));<br>        emp.setUpdateTime(LocalDateTime.now());<br>        emp.setDeptId(<span class="hljs-number">2</span>);<br>        <span class="hljs-comment">//调用方法，修改员工数据</span><br>        empMapper.update(emp);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="2-6-查询">2.6 查询</h4>
<p><strong>根据ID查询</strong></p>
<p>在员工管理的页面中，当我们进行更新数据时，会点击 “编辑” 按钮，然后此时会发送一个请求到服务端，会根据Id查询该员工信息，并将员工数据回显在页面上。</p>
<p>SQL语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 条件查询员工信息</span><br><span class="hljs-keyword">select</span> id, username, password, name, gender, image, job, entrydate, dept_id, create_time, update_time<br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> name <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%张%&#x27;</span><br>  <span class="hljs-keyword">and</span> gender <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br>  <span class="hljs-keyword">and</span> entrydate <span class="hljs-keyword">between</span> <span class="hljs-string">&#x27;2010-01-01&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;2020-01-01 &#x27;</span><br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> update_time <span class="hljs-keyword">desc</span>;<br></code></pre></td></tr></table></figure>
<p>接口方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpMapper</span> &#123;<br><span class="hljs-comment">//    根据Id来查询员工数据</span><br>   <span class="hljs-meta">@Select(&quot;select id, username, password, name, gender, image, job, entrydate, dept_id, &quot; </span><br><span class="hljs-meta">    +    &quot;create_time, update_time from emp where id = #&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> Emp <span class="hljs-title function_">getById</span><span class="hljs-params">(Integer id)</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>测试类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringbootMybatisCrudApplicationTests</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> EmpMapper empMapper;<br><br>    <span class="hljs-comment">//根据id来查询    </span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetById</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">emp</span> <span class="hljs-operator">=</span> empMapper.getById(<span class="hljs-number">2</span>);<br>        System.out.println(emp);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>运行结果：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/39efd9761fb2368f9a87693cd6a00c09.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><strong>数据封装</strong></p>
<p>我们看到查询返回的结果中大部分字段是有值的，但是deptId，createTime，updateTime这几个字段是没有值的，而数据库中是有对应的字段值的，这是为什么呢？</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/f17dac5ef160d7b240869e200ac3d886.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>原因如下：</p>
<ul>
<li>
<p>实体类属性名和数据库表查询返回的字段名一致，mybatis会自动封装。</p>
</li>
<li>
<p>如果实体类属性名和数据库表查询返回的字段名不一致，不能自动封装。</p>
</li>
</ul>
<p>解决方案：</p>
<ol>
<li>
<p>起别名</p>
</li>
<li>
<p>结果映射</p>
</li>
<li>
<p>开启驼峰命名</p>
</li>
</ol>
<p><strong>起别名</strong> ：在SQL语句中，对不一样的列名起别名，别名和实体类属性名一样</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 方法一：起别名</span><br><span class="hljs-meta">@Select(&quot;select id, username, password, name, gender, image, job, entrydate, dept_id deptId, &quot; +</span><br><span class="hljs-meta">     &quot;create_time createTime, update_time updateTime from emp where id = #&#123;id&#125;&quot;)</span><br><span class="hljs-keyword">public</span> Emp <span class="hljs-title function_">getById</span><span class="hljs-params">(Integer id)</span>;<br></code></pre></td></tr></table></figure>
<p><strong>手动结果映射</strong>：通过 @Results及@Result 进行手动结果映射</p>
<blockquote>
<p>@Results({@Result(column = “dept_id”, property = “deptId”),<br>
          @Result(column = “create_time”, property = “createTime”),<br>
          @Result(column = “update_time”, property = “updateTime”)})<br>
@Select(“select id, username, password, name, gender, image, job, entrydate, dept_id, create_time, update_time from emp where id=#{id}”)<br>
public Emp getById(Integer id);</p>
</blockquote>
<p>注：这种方式很繁琐，工作时大概率不会用到；这里标出只是介绍一下，了解即可。</p>
<p><strong>开启驼峰命名(推荐)</strong>：如果字段名与属性名符合驼峰命名规则，mybatis会自动通过驼峰命名规则映射</p>
<p>驼峰命名规则： abc_xyz =&gt; abcXyz</p>
<ul>
<li>
<p>表中字段名：abc_xyz</p>
</li>
<li>
<p>类中属性名：abcXyz</p>
</li>
</ul>
<blockquote>
<p># 在application.properties中添加：<br>
mybatis.configuration.map-underscore-to-camel-case=true</p>
</blockquote>
<p>注：要使用驼峰命名前提是 实体类的属性 与 数据库表中的字段名严格遵守驼峰命名。</p>
<p><strong>条件查询</strong></p>
<p>在员工管理的列表页面中，我们需要根据条件查询员工信息，查询条件包括：姓名、性别、入职时间。</p>
<p>通过页面原型以及需求描述我们要实现的查询：</p>
<ul>
<li>
<p>姓名：要求支持模糊匹配</p>
</li>
<li>
<p>性别：要求精确匹配</p>
</li>
<li>
<p>入职时间：要求进行范围查询</p>
</li>
<li>
<p>根据最后修改时间进行降序排序</p>
</li>
</ul>
<p>SQL语句：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">-- concat 字符串拼接函数<br>select <span class="hljs-title function_">concat</span><span class="hljs-params">(<span class="hljs-string">&#x27;hello&#x27;</span>,<span class="hljs-string">&#x27; nihao&#x27;</span>,<span class="hljs-string">&#x27; 你好&#x27;</span>)</span>;<br><br>-- 条件查询员工信息<br>select id, username, password, name, gender, image, job, entrydate, dept_id, create_time, update_time<br>from emp<br>where name like <span class="hljs-title function_">concat</span><span class="hljs-params">(<span class="hljs-string">&#x27;%&#x27;</span>,<span class="hljs-string">&#x27;张&#x27;</span>,<span class="hljs-string">&#x27;%&#x27;</span>)</span><br>  <span class="hljs-type">and</span> <span class="hljs-variable">gender</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br>  and entrydate between <span class="hljs-string">&#x27;2010-01-01&#x27;</span> and <span class="hljs-string">&#x27;2020-01-01 &#x27;</span><br>order by update_time desc;<br></code></pre></td></tr></table></figure>
<p>接口方法：</p>
<ul>
<li>方式一</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//条件查询员工信息,可能是多条记录，用集合来存储</span><br>    <span class="hljs-meta">@Select(&quot;select id, username, password, name, gender, image, job, entrydate, dept_id, create_time, update_time &quot; +</span><br><span class="hljs-meta">        &quot;from emp &quot; +</span><br><span class="hljs-meta">        &quot;where name like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;)&quot; +</span><br><span class="hljs-meta">        &quot;  and gender = #&#123;gender&#125;&quot; +</span><br><span class="hljs-meta">        &quot;  and entrydate between #&#123;begin&#125; and #&#123;end&#125; &quot; +</span><br><span class="hljs-meta">        &quot;order by update_time desc;&quot;)</span><br><span class="hljs-keyword">public</span> List&lt;Emp&gt; <span class="hljs-title function_">list</span><span class="hljs-params">(String name, Short gender, LocalDate begin, LocalDate end)</span>;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>以上方式注意事项：</p>
<ol>
<li>
<p>方法中的形参名和SQL语句中的参数占位符名保持一致</p>
</li>
<li>
<p>模糊查询使用${…}进行字符串拼接，这种方式呢，由于是字符串拼接，并不是预编译的形式，所以效率不高、且存在sql注入风险。</p>
</li>
</ol>
</blockquote>
<p>方式二（解决SQL注入风险）</p>
<p>使用MySQL提供的字符串拼接函数：concat(‘%’ , ‘关键字’ , ‘%’)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 条件查询员工信息,可能是多条记录，用集合来存储,并且解决SQL注入问题</span><br><span class="hljs-meta">@Select(&quot;select id, username, password, name, gender, image, job, entrydate, dept_id, create_time, update_time &quot; +</span><br><span class="hljs-meta">        &quot;from emp &quot; +</span><br><span class="hljs-meta">        &quot;where name like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;)&quot; +</span><br><span class="hljs-meta">        &quot;  and gender = #&#123;gender&#125;&quot; +</span><br><span class="hljs-meta">        &quot;  and entrydate between #&#123;begin&#125; and #&#123;end&#125; &quot; +</span><br><span class="hljs-meta">        &quot;order by update_time desc;&quot;)</span><br><span class="hljs-keyword">public</span> List&lt;Emp&gt; <span class="hljs-title function_">list</span><span class="hljs-params">(String name, Short gender, LocalDate begin, LocalDate end)</span>;<br></code></pre></td></tr></table></figure>
<p>测试类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testlist</span><span class="hljs-params">()</span>&#123;<br>    List&lt;Emp&gt; empList = empMapper.list(<span class="hljs-string">&quot;Tom&quot;</span>, (<span class="hljs-type">short</span>) <span class="hljs-number">1</span>, LocalDate.of(<span class="hljs-number">2001</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>), LocalDate.of(<span class="hljs-number">2015</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>));<br>    System.out.println(empList);<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="3、Mybatis的XML配置文件">3、Mybatis的XML配置文件</h3>
<h4 id="3-1-XML配置文件规范">3.1 XML配置文件规范</h4>
<p>使用Mybatis的注解方式，主要是来完成一些简单的增删改查功能。如果需要实现复杂的SQL功能，建议使用XML来配置映射语句，也就是将SQL语句写在XML配置文件中。</p>
<p>在Mybatis中使用XML映射文件方式开发，需要符合一定的规范：</p>
<ol>
<li>
<p>XML映射文件的名称与Mapper接口名称一致，并且将XML映射文件和Mapper接口放置在相同包下（同包同名）</p>
</li>
<li>
<p>XML映射文件的namespace属性为Mapper接口全限定名一致</p>
</li>
<li>
<p>XML映射文件中sql语句的id与Mapper接口中的方法名一致，并保持返回类型一致。</p>
</li>
</ol>
<blockquote>
<p><code>&lt;select&gt;</code>标签：就是用于编写select查询语句的。</p>
<ul>
<li>resultType属性，指的是查询返回的单条记录所封装的类型。</li>
</ul>
</blockquote>
<h4 id="3-2-XML配置文件实现">3.2 XML配置文件实现</h4>
<p>第1步：创建XML映射文件</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/5e6578848209ed1e092e912386ad1fc1.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/83ba80007b3ebe80b2a1f15d800873ee.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/015479a563eee78804640b522ff63393.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>第2步：编写XML映射文件</p>
<blockquote>
<p>xml映射文件中的dtd约束，直接从mybatis官网复制即可</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span></span><br><span class="hljs-meta">  <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">  <span class="hljs-string">&quot;https://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>配置：XML映射文件的namespace属性为Mapper接口全限定名</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/f9e5da8b61d10ef97e250886b4f34acf.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span></span><br><span class="hljs-meta">        <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-string">&quot;https://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.itheima.mapper.EmpMapper&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>配置：XML映射文件中sql语句的id与Mapper接口中的方法名一致，并保持返回类型一致</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span></span><br><span class="hljs-meta">        <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-string">&quot;https://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.itheima.mapper.EmpMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--查询操作--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;list&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.itheima.pojo.Emp&quot;</span>&gt;</span><br>        select * from emp<br>        where name like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;)<br>              and gender = #&#123;gender&#125;<br>              and entrydate between #&#123;begin&#125; and #&#123;end&#125;<br>        order by update_time desc<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h4 id="3-3-MybatisX的使用">3.3 MybatisX的使用</h4>
<p>MybatisX是一款基于IDEA的快速开发Mybatis的插件，为效率而生。</p>
<p>MybatisX的安装：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/abb13ee04ec9c6a56045b958ebe5f1cb.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>学习了Mybatis中XML配置文件的开发方式了，大家可能会存在一个疑问：到底是使用注解方式开发还是使用XML方式开发？</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/941afe187f55439f106b6a83f28dd084.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><strong>结论：</strong> 使用Mybatis的注解，主要是来完成一些简单的增删改查功能。如果需要实现复杂的SQL功能，建议使用XML来配置映射语句。</p>
<h3 id="4、动态SQL">4、动态SQL</h3>
<h4 id="4-1-什么是动态SQL？">4.1 什么是动态SQL？</h4>
<p>在我们刚才编写的SQL语句中，我们会看到，我们将三个条件直接写死了。 如果页面只传递了参数姓名name 字段，其他两个字段 性别 和 入职时间没有传递，那么这两个参数的值就是null。</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/889e95449834aa31ea3be88e48b2ddb7.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>这个查询结果是不正确的。正确的做法应该是：传递了参数，再组装这个查询条件；如果没有传递参数，就不应该组装这个查询条件。</p>
<p>比如：如果姓名输入了&quot;张&quot;, 对应的SQL为：</p>
<blockquote>
<p>select *  from emp where name like ‘%张%’ order by update_time desc;</p>
</blockquote>
<p>如果姓名输入了&quot;张&quot;,，性别选择了&quot;男&quot;，则对应的SQL为：</p>
<blockquote>
<p>select *  from emp where name like ‘%张%’ and gender = 1 order by update_time desc;</p>
</blockquote>
<p>SQL语句会随着用户的输入或外部条件的变化而变化，我们称为：<strong>动态SQL</strong>。</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/37c9711cc284c15da2e22b5fdd1751b2.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>在Mybatis中提供了很多实现动态SQL的标签，我们学习Mybatis中的动态SQL就是掌握这些动态SQL标签。</p>
<h4 id="4-2-动态SQL-if">4.2 动态SQL-if</h4>
<p><code>&lt;if&gt;</code>：用于判断条件是否成立。使用test属性进行条件判断，如果条件为true，则拼接SQL。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;条件表达式&quot;</span>&gt;</span>  <br>   要拼接的sql语句   <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>接下来，我们就通过<code>&lt;if&gt;</code>标签来改造之前条件查询的案例。</p>
<p><strong>条件查询</strong></p>
<p><strong>重点：</strong> 使用 <strong><code>&lt;where&gt;</code></strong> 标签代替SQL语句中的where关键字</p>
<p><code>**&lt;where&gt;**</code> 只会在子元素有内容的情况下才插入where子句，而且会自动去除子句的开头的AND或OR。（上面的操作我已经使用了 <strong><code>&lt;where&gt;</code></strong> ）</p>
<p>原有的SQL语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">&lt;</span><span class="hljs-keyword">select</span> id<span class="hljs-operator">=</span>&quot;list&quot; resultType<span class="hljs-operator">=</span>&quot;com.itheima.pojo.Emp&quot;<span class="hljs-operator">&gt;</span><br>        <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp<br>        <span class="hljs-keyword">where</span> name <span class="hljs-keyword">like</span> concat(<span class="hljs-string">&#x27;%&#x27;</span>,#&#123;name&#125;,<span class="hljs-string">&#x27;%&#x27;</span>)<br>              <span class="hljs-keyword">and</span> gender <span class="hljs-operator">=</span> #&#123;gender&#125;<br>              <span class="hljs-keyword">and</span> entrydate <span class="hljs-keyword">between</span> #&#123;<span class="hljs-keyword">begin</span>&#125; <span class="hljs-keyword">and</span> #&#123;<span class="hljs-keyword">end</span>&#125;<br>        <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> update_time <span class="hljs-keyword">desc</span><br><span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span><span class="hljs-keyword">select</span><span class="hljs-operator">&gt;</span><br></code></pre></td></tr></table></figure>
<p>动态SQL语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">&lt;</span><span class="hljs-operator">!</span><span class="hljs-comment">-- resultType：单条记录所封装的类型   --&gt;</span><br><span class="hljs-operator">&lt;</span><span class="hljs-keyword">select</span> id<span class="hljs-operator">=</span>&quot;list&quot; resultType<span class="hljs-operator">=</span>&quot;com.itheima.pojo.Emp&quot;<span class="hljs-operator">&gt;</span><br>    <span class="hljs-operator">&lt;</span>include refid<span class="hljs-operator">=</span>&quot;commonSelect&quot;<span class="hljs-operator">/</span><span class="hljs-operator">&gt;</span><br>    <span class="hljs-operator">&lt;</span><span class="hljs-keyword">where</span><span class="hljs-operator">&gt;</span><br>    <span class="hljs-operator">&lt;</span>if test<span class="hljs-operator">=</span>&quot;name != null&quot;<span class="hljs-operator">&gt;</span><br>        name <span class="hljs-keyword">like</span> concat(<span class="hljs-string">&#x27;%&#x27;</span>,#&#123;name&#125;,<span class="hljs-string">&#x27;%&#x27;</span>)<br>    <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>if<span class="hljs-operator">&gt;</span><br>    <span class="hljs-operator">&lt;</span>if test<span class="hljs-operator">=</span>&quot;gender != null&quot;<span class="hljs-operator">&gt;</span><br>        <span class="hljs-keyword">and</span> gender <span class="hljs-operator">=</span> #&#123;gender&#125;<br>    <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>if<span class="hljs-operator">&gt;</span><br>    <span class="hljs-operator">&lt;</span>if test<span class="hljs-operator">=</span>&quot;begin != null and end != null&quot;<span class="hljs-operator">&gt;</span><br>        <span class="hljs-keyword">and</span> entrydate <span class="hljs-keyword">between</span> #&#123;<span class="hljs-keyword">begin</span>&#125; <span class="hljs-keyword">and</span> #&#123;<span class="hljs-keyword">end</span>&#125;<br>    <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>if<span class="hljs-operator">&gt;</span><br>    <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span><span class="hljs-keyword">where</span><span class="hljs-operator">&gt;</span><br>    <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> update_time <span class="hljs-keyword">desc</span><br><span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span><span class="hljs-keyword">select</span><span class="hljs-operator">&gt;</span><br></code></pre></td></tr></table></figure>
<p>测试方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testlist</span><span class="hljs-params">()</span>&#123;<br>    List&lt;Emp&gt; empList = empMapper.list(<span class="hljs-literal">null</span>, (<span class="hljs-type">short</span>) <span class="hljs-number">1</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br>    System.out.println(empList);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>运行结果：<img src="https://i-blog.csdnimg.cn/blog_migrate/7f5ea4fefe1b5a975492509072dd2f91.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><strong>更新员工</strong></p>
<p>动态更新员工信息，如果更新时传递有值，则更新；如果更新时没有传递值，则不更新。</p>
<p><strong>重点：</strong> 使用 <code>&lt;set&gt;</code> 标签代替SQL语句中的set关键字</p>
<p><code>&lt;set&gt;</code>：动态的在SQL语句中插入set关键字，并会删掉额外的逗号。（用于update语句中）</p>
<p>修改Mapper接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpMapper</span> &#123;    <br>    <span class="hljs-comment">//删除@Update注解编写的SQL语句   </span><br>    <span class="hljs-comment">//update操作的SQL语句编写在Mapper映射文件中    </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(Emp emp)</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>修改Mapper映射文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;update2&quot;</span> &gt;</span><br>    update emp<br>    <span class="hljs-tag">&lt;<span class="hljs-name">set</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;username != null&quot;</span>&gt;</span><br>        username=#&#123;username&#125;,<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name != null&quot;</span>&gt;</span><br>        name=#&#123;name&#125;,<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;gender != null&quot;</span>&gt;</span><br>        gender=#&#123;gender&#125;,<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;image != null&quot;</span>&gt;</span><br>        image=#&#123;image&#125;,<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;job != null&quot;</span>&gt;</span><br>        job=#&#123;job&#125;,<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;entrydate != null&quot;</span>&gt;</span><br>        entrydate=#&#123;entrydate&#125;,<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;deptId != null&quot;</span>&gt;</span><br>        dept_id=#&#123;deptId&#125;,<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;updateTime != null&quot;</span>&gt;</span><br>        update_time=#&#123;updateTime&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span><br>    where id=#&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>测试方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testUpdate2</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//要修改的员工信息</span><br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">emp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Emp</span>();<br>        emp.setId(<span class="hljs-number">20</span>);<br>        emp.setUsername(<span class="hljs-string">&quot;Tom111&quot;</span>);<br>        emp.setName(<span class="hljs-string">&quot;汤姆111&quot;</span>);<br><br>        emp.setUpdateTime(LocalDateTime.now());<br><br>        <span class="hljs-comment">//调用方法，修改员工数据</span><br>        empMapper.update(emp);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>运行结果：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/39671172995ca83468310f358e40d22f.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><strong>小结：</strong></p>
<p><strong>1、<code>&lt;if&gt;</code></strong></p>
<p>用于判断条件是否成立，如果成立为true，否则拼接SQL</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">形式：<span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name != null&quot;</span>&gt;</span> … <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p><strong>2、 <code>&lt;where&gt;</code></strong></p>
<p>where元素只会在子元素有内容的情况下才插入where子句，而且会自动去除子句的开头的AND或OR</p>
<p><strong>3、 <code>&lt;set&gt;</code></strong></p>
<p>动态地在行首插入 SET 关键字，并会删掉额外的逗号。（用在update语句中）</p>
<h4 id="4-3-动态SQL-foreach">4.3 动态SQL-foreach</h4>
<p>案例：员工删除功能（既支持删除单条记录，又支持批量删除）</p>
<p>SQL语句：</p>
<blockquote>
<p>delete from emp where id in (1,2,3);</p>
</blockquote>
<p>Mapper接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpMapper</span> &#123;<br>    <span class="hljs-comment">//批量删除</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteByIds</span><span class="hljs-params">(List&lt;Integer&gt; ids)</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>XML映射文件：</p>
<p>使用 <strong><code>&lt;foreach&gt;</code></strong> 遍历deleteByIds方法中传递的参数ids集合</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">foreach</span> <span class="hljs-attr">collection</span>=<span class="hljs-string">&quot;集合名称&quot;</span> <span class="hljs-attr">item</span>=<span class="hljs-string">&quot;集合遍历出来的元素/项&quot;</span> <span class="hljs-attr">separator</span>=<span class="hljs-string">&quot;每一次遍历使用的分隔符&quot;</span> </span><br><span class="hljs-tag">         <span class="hljs-attr">open</span>=<span class="hljs-string">&quot;遍历开始前拼接的片段&quot;</span> <span class="hljs-attr">close</span>=<span class="hljs-string">&quot;遍历结束后拼接的片段&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">foreach</span>&gt;</span><br></code></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span></span><br><span class="hljs-meta">        <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-string">&quot;https://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.itheima.mapper.EmpMapper&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--删除操作--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;deleteByIds&quot;</span>&gt;</span><br>        delete from emp where id in<br>        <span class="hljs-tag">&lt;<span class="hljs-name">foreach</span> <span class="hljs-attr">collection</span>=<span class="hljs-string">&quot;ids&quot;</span> <span class="hljs-attr">item</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">separator</span>=<span class="hljs-string">&quot;,&quot;</span> <span class="hljs-attr">open</span>=<span class="hljs-string">&quot;(&quot;</span> <span class="hljs-attr">close</span>=<span class="hljs-string">&quot;)&quot;</span>&gt;</span><br>            #&#123;id&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">foreach</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span> <br></code></pre></td></tr></table></figure>
<p>执行的SQL语句：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/6b5a21ec8c402c01c427a6f2bf657371.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h4 id="4-4-动态SQL-sql-include">4.4 动态SQL-sql&amp;include</h4>
<p>问题分析：</p>
<p>在xml映射文件中配置的SQL，有时可能会存在很多重复的片段，此时就会存在很多冗余的代码</p>
<blockquote>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> id, username, <span class="hljs-keyword">password</span>, <span class="hljs-type">name</span>, gender, image, job, entrydate, dept_id, create_time, update_time  <span class="hljs-keyword">from</span> emp<br></code></pre></td></tr></table></figure>
</blockquote>
<p>我们可以对重复的代码片段进行抽取，将其通过<code>&lt;sql&gt;</code>标签封装到一个SQL片段，然后再通过<code>&lt;include&gt;</code>标签进行引用。</p>
<ul>
<li>
<p><strong><code>&lt;sql&gt;</code>：</strong> 定义可重用的SQL片段</p>
</li>
<li>
<p><strong><code>&lt;include&gt;</code>：</strong> 通过属性refid，指定包含的SQL片段</p>
</li>
</ul>
<p>SQL片段： 抽取重复的代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml">//抽取重复的代码<br><span class="hljs-tag">&lt;<span class="hljs-name">sql</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;commonSelect&quot;</span>&gt;</span><br>    select id, username, password, name, gender, image, job, entrydate, dept_id, create_time, update_time<br>    from emp<br><span class="hljs-tag">&lt;/<span class="hljs-name">sql</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>然后通过**<code>&lt;include&gt;</code>** 标签在原来抽取的地方进行引用。操作如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;list&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.itheima.pojo.Emp&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;commonSelect&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name != null&quot;</span>&gt;</span><br>        name like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;gender != null&quot;</span>&gt;</span><br>        and gender = #&#123;gender&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;begin != null and end != null&quot;</span>&gt;</span><br>        and entrydate between #&#123;begin&#125; and #&#123;end&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span><br>    order by update_time desc<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>注:本文是一篇比较详细的笔记</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div></div>
      <div>http://example.com/2025/06/24/Java/Framework/Spring Boot/Data/MyBatis/mybatis详细教程/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Han Di</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年6月24日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/06/24/Java/Framework/Spring%20Boot/Data/MyBatis/%E5%85%A8%E9%9D%A2%E5%9C%B0%E6%8E%A2%E8%AE%A8/" title="">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile"></span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/06/24/Java/Framework/Spring%20Boot/Data/MyBatis/mybatis-rg1/" title="">
                        <span class="hidden-mobile"></span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  <div>
    <span id="timeDate">正在载入天数...</span>
    <span id="times">载入时分秒...</span>
    <script>
    var now = new Date();
    function createtime(){
      var grt= new Date("08/17/2020 00:00:00");
      now.setTime(now.getTime()+250);
      days = (now - grt ) / 1000 / 60 / 60 / 24;
      dnum = Math.floor(days);
      hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
      hnum = Math.floor(hours);
      if(String(hnum).length ==1 ){
          hnum = "0" + hnum;
      }
      minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
      mnum = Math.floor(minutes);
      if(String(mnum).length ==1 ){
                mnum = "0" + mnum;
      }
      seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
      snum = Math.round(seconds);
      if(String(snum).length ==1 ){
                snum = "0" + snum;
      }
      document.getElementById("timeDate").innerHTML = "已持续航行&nbsp"+dnum+"&nbsp天";  
      document.getElementById("times").innerHTML = hnum + "&nbsp时&nbsp" + mnum + "&nbsp分&nbsp" + snum + "&nbsp秒";
    }
    setInterval("createtime()",250);
    </script>
  </div>

  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
    <!-- 备案信息 ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      京ICP证123456号
    </a>
  </span>
  
    
      <span>
        <a
          href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=12345678"
          rel="nofollow noopener"
          class="beian-police"
          target="_blank"
        >
          
            <span style="visibility: hidden; width: 0">|</span>
            <img src="/img/police_beian.png" srcset="/img/loading.gif" lazyload alt="police-icon"/>
          
          <span>京公网安备12345678号</span>
        </a>
      </span>
    
  
</div>

  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  
<script src="/js/scrollAnimation.js"></script>
<script src="/js/DynamicLine.min.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<!-- hexo injector body_end start --><script src="/js/backgroundize.js"></script><!-- hexo injector body_end end --></body>
</html>
