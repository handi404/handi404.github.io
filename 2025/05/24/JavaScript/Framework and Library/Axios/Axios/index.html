

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Han Di">
  <meta name="keywords" content="">
  
    <meta name="description" content="无痛迁移与核心体验 用 Axios 完成最常见的 GET 和 POST 请求，并直观感受它相比 fetch 的三大核心优势：数据处理更简单、错误处理更自然、功能更集成。  1. 安装与引入 首先，在你的项目里安装 Axios。 1npm install axios 然后在你的 JavaScript 文件中引入它： 1import axios from &#x27;axios&#x27;;  2.">
<meta property="og:type" content="article">
<meta property="og:title" content="Fetch -&gt; Axios">
<meta property="og:url" content="http://example.com/2025/05/24/JavaScript/Framework%20and%20Library/Axios/Axios/index.html">
<meta property="og:site_name" content="繁星的蓝">
<meta property="og:description" content="无痛迁移与核心体验 用 Axios 完成最常见的 GET 和 POST 请求，并直观感受它相比 fetch 的三大核心优势：数据处理更简单、错误处理更自然、功能更集成。  1. 安装与引入 首先，在你的项目里安装 Axios。 1npm install axios 然后在你的 JavaScript 文件中引入它： 1import axios from &#x27;axios&#x27;;  2.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/fronted/axios.png">
<meta property="article:published_time" content="2025-05-23T16:00:00.000Z">
<meta property="article:modified_time" content="2025-07-17T10:48:20.855Z">
<meta property="article:author" content="Han Di">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/fronted/axios.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Fetch -&gt; Axios - 繁星的蓝</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/macpanel.css">
<link rel="stylesheet" href="/css/scrollAnimation.css">
<link rel="stylesheet" href="/css/glassBg.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body><!-- hexo injector body_begin start --><div id="web_bg"></div><!-- hexo injector body_begin end -->
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>HAN&#39;S BLOG</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/post.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Fetch -&gt; Axios"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-05-24 00:00" pubdate>
          2025年5月24日 凌晨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          6.5k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          54 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Fetch -&gt; Axios</h1>
            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    本文最后更新于 2025年7月17日 晚上
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <h2 id="无痛迁移与核心体验">无痛迁移与核心体验</h2>
<p>用 Axios 完成最常见的 GET 和 POST 请求，并直观感受它相比 <code>fetch</code> 的三大核心优势：<strong>数据处理更简单</strong>、<strong>错误处理更自然</strong>、<strong>功能更集成</strong>。</p>
<hr>
<h3 id="1-安装与引入">1. 安装与引入</h3>
<p>首先，在你的项目里安装 Axios。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install axios<br></code></pre></td></tr></table></figure>
<p>然后在你的 JavaScript 文件中引入它：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span>;<br></code></pre></td></tr></table></figure>
<hr>
<h3 id="2-发起-GET-请求（获取数据）">2. 发起 GET 请求（获取数据）</h3>
<p>假设我们要从 <code>/api/users/1</code> 获取 ID 为 1 的用户信息。</p>
<h4 id="回顾：fetch-的方式"><strong>回顾：<code>fetch</code> 的方式</strong></h4>
<p>你需要两步操作：1. 发起请求；2. 手动将响应体解析为 JSON。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// fetch 方式</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserWithFetch</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/api/users/1&#x27;</span>);<br>    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>(); <span class="hljs-comment">// &lt;-- 需要手动调用 .json()</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);<br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;网络请求失败:&#x27;</span>, error);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="现代：Axios-的方式"><strong>现代：Axios 的方式</strong></h4>
<p>Axios 将这两步合二为一。响应数据直接在 <code>response.data</code> 中，并且已经自动帮你解析好了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// axios 方式</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserWithAxios</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-comment">// 使用对象解构，直接获取 data</span><br>    <span class="hljs-keyword">const</span> &#123; data &#125; = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/users/1&#x27;</span>); <span class="hljs-comment">// &lt;-- 一步到位</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data); <span class="hljs-comment">// data 就是解析好的 JSON 对象</span><br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    <span class="hljs-comment">// 错误处理，稍后详述</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;请求出错:&#x27;</span>, error);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p><strong>Axios 核心优势 (1/3): 自动的 JSON 转换</strong></p>
<ul>
<li><strong><code>fetch</code></strong>: 你总是需要检查响应是否成功，然后调用 <code>res.json()</code> 或 <code>res.text()</code>。</li>
<li><strong><code>axios</code></strong>: 响应体 (<code>response.data</code>) 已经根据响应头的 <code>Content-Type</code> 自动解析完毕。你几乎不需要关心这个过程，直接使用数据即可。这减少了大量重复的模板代码。</li>
</ul>
</blockquote>
<p><strong>扩展知识：Axios 的响应对象</strong><br>
虽然我们通常只用 <code>data</code>，但 Axios 的完整响应对象 <code>response</code> 包含了所有你需要的信息，非常便于调试：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/users/1&#x27;</span>);<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">data</span>);      <span class="hljs-comment">// &#123; id: 1, name: &#x27;张三&#x27; &#125; (我们最常用的)</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">status</span>);    <span class="hljs-comment">// 200</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">statusText</span>);<span class="hljs-comment">// &#x27;OK&#x27;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">headers</span>);   <span class="hljs-comment">// &#123; &#x27;content-type&#x27;: &#x27;application/json&#x27;, ... &#125;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">config</span>);    <span class="hljs-comment">// 发起这个请求时的完整配置信息</span><br></code></pre></td></tr></table></figure>
<hr>
<h3 id="3-发起-POST-请求（提交数据）">3. 发起 POST 请求（提交数据）</h3>
<p>假设我们要提交一个登录表单，数据为 <code>&#123; username: 'admin', password: '123' &#125;</code>。</p>
<h4 id="回顾：fetch-的方式-2"><strong>回顾：<code>fetch</code> 的方式</strong></h4>
<p>你需要三步操作：1. 手动将 JS 对象序列化为 JSON 字符串；2. 在 <code>headers</code> 中手动设置 <code>Content-Type</code>；3. 发起请求。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// fetch 方式</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loginWithFetch</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> loginData = &#123; <span class="hljs-attr">username</span>: <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-attr">password</span>: <span class="hljs-string">&#x27;123&#x27;</span> &#125;;<br><br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/api/login&#x27;</span>, &#123;<br>      <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-attr">headers</span>: &#123;<br>        <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span>, <span class="hljs-comment">// &lt;-- 必须手动设置</span><br>      &#125;,<br>      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(loginData), <span class="hljs-comment">// &lt;-- 必须手动序列化</span><br>    &#125;);<br>    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result);<br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;网络请求失败:&#x27;</span>, error);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="现代：Axios-的方式-2"><strong>现代：Axios 的方式</strong></h4>
<p>Axios 再次简化了一切。你只需将 JS 对象作为第二个参数传入，它会自动帮你完成序列化和设置请求头。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// axios 方式</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loginWithAxios</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> loginData = &#123; <span class="hljs-attr">username</span>: <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-attr">password</span>: <span class="hljs-string">&#x27;123&#x27;</span> &#125;;<br><br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-comment">// 直接把 JS 对象作为数据传递</span><br>    <span class="hljs-keyword">const</span> &#123; data &#125; = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/login&#x27;</span>, loginData); <span class="hljs-comment">// &lt;-- 优雅，简洁</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);<br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;请求出错:&#x27;</span>, error);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p><strong>Axios 核心优势 (2/3): 自动的数据序列化</strong></p>
<ul>
<li><strong><code>fetch</code></strong>: 你需要时刻记住为不同 <code>Content-Type</code> 做不同的数据处理（<code>JSON.stringify</code> for <code>json</code>, <code>new FormData()</code> for <code>multipart/form-data</code>…）。</li>
<li><strong><code>axios</code></strong>: 当你传递一个普通 JS 对象时，它默认会帮你序列化成 JSON 并设置好请求头。这让你能更专注于业务逻辑，而不是 HTTP 的细节。</li>
</ul>
</blockquote>
<hr>
<h3 id="4-错误处理（关键区别！）">4. 错误处理（关键区别！）</h3>
<p>这是 Axios 最为人称道的优点之一。</p>
<h4 id="fetch-的痛点"><strong><code>fetch</code> 的痛点</strong></h4>
<p><code>fetch</code> 只有在网络层面失败（比如断网、DNS 查询失败）时才会 <code>reject</code> Promise (进入 <code>catch</code> 块)。对于像 404 (Not Found)、500 (Server Error) 这样的 HTTP 错误，<code>fetch</code> 会认为请求是“成功”的（<code>resolve</code>），你必须在 <code>then</code> 里面通过 <code>response.ok</code> 属性来手动判断。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// fetch 必须手动检查 HTTP 状态</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchErrorExample</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/api/a-path-that-does-not-exist&#x27;</span>); <span class="hljs-comment">// 假设返回 404</span><br>    <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) &#123; <span class="hljs-comment">// &lt;-- 必须加这行判断！</span><br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">$&#123;response.status&#125;</span>`</span>);<br>    &#125;<br>    <span class="hljs-comment">// ...</span><br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="Axios-的优雅之处"><strong>Axios 的优雅之处</strong></h4>
<p>Axios 对 HTTP 错误的处理方式更符合编程直觉：<strong>任何非 2xx 的状态码都会导致 Promise 被 <code>reject</code></strong>。这意味着所有类型的错误（网络错误、HTTP 错误）都可以被同一个 <code>catch</code> 块捕获。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// axios 自动处理 HTTP 错误</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">axiosErrorExample</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-comment">// 这一行会直接抛出异常，代码会立即跳转到 catch 块</span><br>    <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/a-path-that-does-not-exist&#x27;</span>); <span class="hljs-comment">// 假设返回 404</span><br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    <span class="hljs-keyword">if</span> (error.<span class="hljs-property">response</span>) &#123;<br>      <span class="hljs-comment">// 请求已发出，服务器用状态码响应 (非 2xx)</span><br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;服务器响应错误:&#x27;</span>, error.<span class="hljs-property">response</span>.<span class="hljs-property">data</span>);<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;状态码:&#x27;</span>, error.<span class="hljs-property">response</span>.<span class="hljs-property">status</span>);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (error.<span class="hljs-property">request</span>) &#123;<br>      <span class="hljs-comment">// 请求已发出，但没有收到响应 (例如断网)</span><br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;网络错误，未收到响应:&#x27;</span>, error.<span class="hljs-property">request</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-comment">// 在设置请求时触发了一些错误</span><br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;请求配置错误:&#x27;</span>, error.<span class="hljs-property">message</span>);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p><strong>Axios 核心优势 (3/3): 统一的错误处理模型</strong></p>
<ul>
<li><strong><code>fetch</code></strong>: 你需要区分处理“网络失败”和“HTTP 失败”，容易遗漏判断，导致 bug。</li>
<li><strong><code>axios</code></strong>: 统一使用 <code>try...catch</code> 处理所有问题。并且 <code>error</code> 对象包含了极其丰富的信息（<code>response</code>, <code>request</code>, <code>config</code>），让你能轻松定位问题所在。</li>
</ul>
</blockquote>
<hr>
<h3 id="第一阶段总结"><strong>第一阶段总结</strong></h3>
<p>掌握了 Axios 的核心用法，并体验了它相比 <code>fetch</code> 的三大便利：</p>
<ol>
<li><strong>自动 JSON 解析</strong>：<code>response.data</code> 直接可用。</li>
<li><strong>自动数据序列化</strong>：<code>post</code> 请求直接传对象。</li>
<li><strong>统一错误处理</strong>：所有非 2xx 状态码自动进入 <code>catch</code>。</li>
</ol>
<h2 id="掌握精髓-全局配置与拦截器">掌握精髓 - 全局配置与拦截器</h2>
<p><strong>目标：</strong> 学会使用 Axios 最强大的功能——创建实例和拦截器。这是从“会用”到“会组织”的关键一步，也是区分 Axios 和 <code>fetch</code> 的核心所在。完成这个阶段，你就能搭建出企业级的、可维护的请求架构。</p>
<hr>
<h3 id="1-为什么要创建实例？-axios-create">1. 为什么要创建实例？(<code>axios.create</code>)</h3>
<p>在第一阶段，我们使用的是全局的 <code>axios</code> 对象，例如 <code>axios.get(...)</code>。这在小练习中没问题，但在真实项目中，<strong>强烈不推荐</strong>。</p>
<p><strong>问题场景：</strong><br>
想象你的应用需要同时请求两个不同的 API 服务：</p>
<ol>
<li><strong>我方后端服务：</strong> <code>https://api.my-app.com/v1</code>，所有请求都需要带上 <code>Authorization</code> token。</li>
<li><strong>一个公开的天气服务：</strong> <code>https://api.weather.com</code>，不需要任何特殊配置。</li>
</ol>
<p>如果使用全局 <code>axios</code>，你会很痛苦。为我方后端设置的 <code>headers</code> 会被错误地发送到天气服务，为天气服务设置的 <code>timeout</code> 也可能不适用于我方后端。它们互相干扰。</p>
<p><strong>解决方案：<code>axios.create()</code></strong></p>
<p><code>axios.create()</code> 可以创建一个全新的、隔离的 Axios 实例。每个实例都可以有自己独立的配置（<code>baseURL</code>, <code>headers</code>, <code>timeout</code> 等）。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span>;<br><br><span class="hljs-comment">// 实例1: 用于请求我方后端 API</span><br><span class="hljs-keyword">const</span> myApi = axios.<span class="hljs-title function_">create</span>(&#123;<br>  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">&#x27;https://api.my-app.com/v1&#x27;</span>,<br>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span>, <span class="hljs-comment">// 请求超时时间 5s</span><br>&#125;);<br><br><span class="hljs-comment">// 实例2: 用于请求天气服务</span><br><span class="hljs-keyword">const</span> weatherApi = axios.<span class="hljs-title function_">create</span>(&#123;<br>  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">&#x27;https://api.weather.com&#x27;</span>,<br>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>,<br>&#125;);<br><br><span class="hljs-comment">// 使用起来和全局 axios 一样，但配置是独立的</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchData</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// 请求会发往: https://api.my-app.com/v1/users</span><br>  <span class="hljs-keyword">const</span> &#123; <span class="hljs-attr">data</span>: users &#125; = <span class="hljs-keyword">await</span> myApi.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/users&#x27;</span>);<br><br>  <span class="hljs-comment">// 请求会发往: https://api.weather.com/forecast?city=beijing</span><br>  <span class="hljs-keyword">const</span> &#123; <span class="hljs-attr">data</span>: forecast &#125; = <span class="hljs-keyword">await</span> weatherApi.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/forecast&#x27;</span>, &#123;<br>    <span class="hljs-attr">params</span>: &#123; <span class="hljs-attr">city</span>: <span class="hljs-string">&#x27;beijing&#x27;</span> &#125; <span class="hljs-comment">// GET 请求传参的正确方式</span><br>  &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p><strong>Axios 核心优势 (4/5): 实例隔离与模块化</strong></p>
<ul>
<li><strong><code>fetch</code></strong>: 没有实例概念。你需要自己封装大量函数来管理不同 API 的 <code>baseURL</code>、<code>headers</code> 等，非常繁琐且容易出错。</li>
<li><strong><code>axios</code></strong>: 通过 <code>axios.create()</code>，可以为不同的服务创建独立的、预配置好的客户端。这是构建大型应用的基础。</li>
</ul>
</blockquote>
<hr>
<h3 id="2-拦截器-Interceptors-Axios-的灵魂">2. 拦截器 (Interceptors) - Axios 的灵魂</h3>
<p>拦截器允许你在请求被<strong>发送前</strong>或响应被<strong>处理前</strong>拦截并修改它们。这是 Axios 最强大的功能，没有之一。它让你能将通用逻辑（如认证、日志、格式化）从业务代码中抽离出来。</p>
<p>拦截器分为两种：<strong>请求拦截器</strong>和<strong>响应拦截器</strong>。</p>
<h4 id="请求拦截器-request-use"><strong>请求拦截器 (<code>request.use</code>)</strong></h4>
<p><strong>最经典场景：自动添加 Token</strong></p>
<p>假设用户登录后，你得到了一个 token，后续所有对我方后端的请求都需要在请求头中携带 <code>Authorization: Bearer &lt;token&gt;</code>。</p>
<p><strong>没有拦截器的做法（很糟糕）：</strong><br>
你需要在每个请求中手动添加 <code>headers</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> token = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&#x27;token&#x27;</span>);<br>myApi.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/profile&#x27;</span>, &#123; <span class="hljs-attr">headers</span>: &#123; <span class="hljs-string">&#x27;Authorization&#x27;</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">$&#123;token&#125;</span>`</span> &#125; &#125;);<br>myApi.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/posts&#x27;</span>, data, &#123; <span class="hljs-attr">headers</span>: &#123; <span class="hljs-string">&#x27;Authorization&#x27;</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">$&#123;token&#125;</span>`</span> &#125; &#125;);<br><span class="hljs-comment">// ... 重复，噩梦！</span><br></code></pre></td></tr></table></figure>
<p><strong>使用请求拦截器（优雅）：</strong><br>
在创建 <code>myApi</code> 实例后，为其设置一个请求拦截器。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 在 myApi 实例上设置请求拦截器</span><br>myApi.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(<br>  <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 在请求被发送之前做些什么</span><br>    <span class="hljs-keyword">const</span> token = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&#x27;token&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (token) &#123;<br>      config.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">$&#123;token&#125;</span>`</span>;<br>    &#125;<br>    <span class="hljs-comment">// 必须返回 config 对象，否则请求会被阻塞</span><br>    <span class="hljs-keyword">return</span> config;<br>  &#125;,<br>  <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 对请求错误做些什么</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);<br>  &#125;<br>);<br><br><span class="hljs-comment">// 现在，所有使用 myApi 的请求都会自动带上 token！</span><br><span class="hljs-comment">// 业务代码变得极其干净</span><br><span class="hljs-keyword">await</span> myApi.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/profile&#x27;</span>);<br><span class="hljs-keyword">await</span> myApi.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/posts&#x27;</span>, &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;New Post&#x27;</span> &#125;);<br></code></pre></td></tr></table></figure>
<h4 id="响应拦截器-response-use"><strong>响应拦截器 (<code>response.use</code>)</strong></h4>
<p><strong>场景 1：简化数据结构</strong></p>
<p>我们已经知道 Axios 的响应数据在 <code>response.data</code> 中。在业务代码里，我们总是写 <code>const &#123; data &#125; = await myApi.get(...)</code>。这有点重复。我们可以用响应拦截器来简化它。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 在 myApi 实例上设置响应拦截器</span><br>myApi.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(<br>  <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 状态码为 2xx 时进入这里</span><br>    <span class="hljs-comment">// 直接返回 response.data，业务代码就可以直接拿到数据了</span><br>    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>;<br>  &#125;,<br>  <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 任何非 2xx 的状态码都会进入这里</span><br>    <span class="hljs-comment">// 这里可以做统一的错误处理</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);<br>  &#125;<br>);<br><br><span class="hljs-comment">// 使用起来更爽了！</span><br><span class="hljs-comment">// 之前: const &#123; data: profile &#125; = await myApi.get(&#x27;/profile&#x27;);</span><br><span class="hljs-comment">// 现在: const profile = await myApi.get(&#x27;/profile&#x27;);</span><br><span class="hljs-comment">// profile 直接就是后端返回的数据对象</span><br></code></pre></td></tr></table></figure>
<p><strong>场景 2：统一错误处理</strong></p>
<p>这是响应拦截器最强大的用途。比如，当后端返回 <code>401 Unauthorized</code> (通常是 token 失效)，我们应该清除本地 token 并跳转到登录页。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs javascript">myApi.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(<br>  <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>;<br>  &#125;,<br>  <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 统一处理 HTTP 错误</span><br>    <span class="hljs-keyword">if</span> (error.<span class="hljs-property">response</span>) &#123;<br>      <span class="hljs-keyword">switch</span> (error.<span class="hljs-property">response</span>.<span class="hljs-property">status</span>) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">401</span>:<br>          <span class="hljs-comment">// Token 失效，跳转到登录页</span><br>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;认证失败，请重新登录&#x27;</span>);<br>          <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">&#x27;token&#x27;</span>);<br>          <span class="hljs-comment">// location.href = &#x27;/login&#x27;; // 实际项目中会这样做</span><br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">404</span>:<br>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;请求的资源未找到&#x27;</span>);<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">500</span>:<br>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;服务器内部错误&#x27;</span>);<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-attr">default</span>:<br>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`发生错误: <span class="hljs-subst">$&#123;error.response.status&#125;</span>`</span>);<br>      &#125;<br>    &#125;<br>    <span class="hljs-comment">// 将错误继续抛出，以便业务代码中的 catch 块可以捕获</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);<br>  &#125;<br>);<br><br><span class="hljs-comment">// 业务代码中</span><br><span class="hljs-keyword">try</span> &#123;<br>  <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> myApi.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/user-that-might-not-exist&#x27;</span>);<br>&#125; <span class="hljs-keyword">catch</span>(err) &#123;<br>  <span class="hljs-comment">// 这里仍然可以捕获到错误，进行针对性的 UI 处理</span><br>  <span class="hljs-comment">// 但通用的错误提示（如 401 跳转）已经在拦截器中处理了</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;在业务代码中捕获到了错误，可以更新 UI 状态&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p><strong>Axios 核心优势 (5/5): AOP 式的请求/响应处理</strong></p>
<ul>
<li><strong><code>fetch</code></strong>: 没有拦截器。所有通用逻辑都必须通过函数包装来实现，这被称为“高阶函数”或“组合”模式。虽然可行，但代码结构远不如拦截器清晰直观。</li>
<li><strong><code>axios</code></strong>: 拦截器提供了完美的“切面”（Aspect），让你能优雅地将通用逻辑注入到所有请求的生命周期中，实现了业务代码和基础设置的完全解耦。</li>
</ul>
</blockquote>
<hr>
<h3 id="第二阶段总结"><strong>第二阶段总结</strong></h3>
<p>现在你已经掌握了 Axios 的两大王牌：<strong>实例创建</strong>和<strong>拦截器</strong>。</p>
<ol>
<li><strong><code>axios.create()</code></strong>: 为不同服务创建独立配置的客户端，实现模块化。</li>
<li><strong><code>interceptors.request.use()</code></strong>: 在请求前统一处理，如添加 Token、加载动画。</li>
<li><strong><code>interceptors.response.use()</code></strong>: 在响应后统一处理，如简化数据、全局错误处理。</li>
</ol>
<h2 id="企业级封装与模块化">企业级封装与模块化</h2>
<p>将这些武器组合起来，构建一个真正健壮、可维护、可扩展的 API 层。这部分内容更多是关于<strong>工程化和代码组织</strong>，是区分初级和资深开发者的重要分水岭。</p>
<p><strong>目标：</strong> 将 Axios 实例和所有 API 请求进行模块化组织，形成一个清晰的、团队成员都能轻松理解和使用的 API 层。</p>
<hr>
<h3 id="1-封装统一的-Axios-实例">1. 封装统一的 Axios 实例</h3>
<p>在真实项目中，我们不会在业务组件里直接导入和使用 <code>axios</code> 或 <code>axios.create()</code>。我们会创建一个专门的文件来负责这件事。这遵循了“单一职责原则”。</p>
<p><strong>实践：创建 <code>request.js</code> 文件</strong></p>
<p>在你的项目 <code>src</code> 目录下，创建一个类似 <code>utils/request.js</code> 或 <code>api/index.js</code> 的文件。这个文件将做三件事：</p>
<ol>
<li>创建并配置 Axios 实例。</li>
<li>设置请求和响应拦截器。</li>
<li>导出这个配置好的实例。</li>
</ol>
<p><strong><code>src/utils/request.js</code> 文件示例：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span>;<br><br><span class="hljs-comment">// 1. 创建 Axios 实例</span><br><span class="hljs-keyword">const</span> service = axios.<span class="hljs-title function_">create</span>(&#123;<br>  <span class="hljs-comment">// 在 .env 文件中配置 VUE_APP_BASE_API (或 VITE_API_BASE_URL)</span><br>  <span class="hljs-comment">// 这样可以方便地在不同环境（开发、测试、生产）中使用不同的 API 地址</span><br>  <span class="hljs-attr">baseURL</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">VUE_APP_BASE_API</span> || <span class="hljs-string">&#x27;/api&#x27;</span>, <br>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>, <span class="hljs-comment">// 请求超时时间</span><br>&#125;);<br><br><span class="hljs-comment">// 2. 请求拦截器</span><br>service.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(<br>  <span class="hljs-function"><span class="hljs-params">config</span> =&gt;</span> &#123;<br>    <span class="hljs-comment">// 在发送请求前做些什么，比如加上 token</span><br>    <span class="hljs-keyword">const</span> token = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&#x27;token&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (token) &#123;<br>      config.<span class="hljs-property">headers</span>[<span class="hljs-string">&#x27;Authorization&#x27;</span>] = <span class="hljs-string">&#x27;Bearer &#x27;</span> + token;<br>    &#125;<br>    <span class="hljs-keyword">return</span> config;<br>  &#125;,<br>  <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;<br>    <span class="hljs-comment">// 对请求错误做些什么</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error); <span class="hljs-comment">// for debug</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);<br>  &#125;<br>);<br><br><span class="hljs-comment">// 3. 响应拦截器</span><br>service.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(<br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * 如果你想直接获取像 headers 或 status 这样的信息</span><br><span class="hljs-comment">   * 请直接 return  response</span><br><span class="hljs-comment">  */</span><br>  <span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;<br>    <span class="hljs-comment">// 对响应数据做点什么</span><br>    <span class="hljs-comment">// 假设后端返回的数据结构总是: &#123; code: 200, message: &#x27;...&#x27;, data: ... &#125;</span><br>    <span class="hljs-keyword">const</span> res = response.<span class="hljs-property">data</span>;<br><br>    <span class="hljs-comment">// 如果 code 不是 20000 (或 200)，则判定为错误。</span><br>    <span class="hljs-comment">// 这里只是一个例子，请根据你自己的后端接口规范进行修改</span><br>    <span class="hljs-keyword">if</span> (res.<span class="hljs-property">code</span> !== <span class="hljs-number">20000</span> &amp;&amp; res.<span class="hljs-property">code</span> !== <span class="hljs-number">200</span>) &#123;<br>      <span class="hljs-comment">// 弹出错误信息，例如使用 Element Plus 的 Message 组件</span><br>      <span class="hljs-comment">// Message(&#123; message: res.message || &#x27;Error&#x27;, type: &#x27;error&#x27; &#125;);</span><br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;API Error: &#x27;</span> + res.<span class="hljs-property">message</span>);<br><br>      <span class="hljs-comment">// 50008: Illegal token; 50012: Other clients logged in; 50014: Token expired;</span><br>      <span class="hljs-keyword">if</span> (res.<span class="hljs-property">code</span> === <span class="hljs-number">50008</span> || res.<span class="hljs-property">code</span> === <span class="hljs-number">50012</span> || res.<span class="hljs-property">code</span> === <span class="hljs-number">50014</span>) &#123;<br>        <span class="hljs-comment">// 可以做一个弹窗，确认后重定向到登录页</span><br>        <span class="hljs-comment">// MessageBox.confirm(&#x27;You have been logged out, you can cancel to stay on this page, or log in again&#x27;, &#x27;Confirm logout&#x27;, &#123; ... &#125;)</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Token expired, redirect to login&#x27;</span>);<br>      &#125;<br>      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(res.<span class="hljs-property">message</span> || <span class="hljs-string">&#x27;Error&#x27;</span>));<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-comment">// 如果 code 正确，则直接返回 data 部分</span><br>      <span class="hljs-keyword">return</span> res.<span class="hljs-property">data</span>;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;<br>    <span class="hljs-comment">// 处理 HTTP 网络错误</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;HTTP Error: &#x27;</span> + error); <span class="hljs-comment">// for debug</span><br>    <span class="hljs-comment">// Message(&#123; message: error.message, type: &#x27;error&#x27; &#125;);</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);<br>  &#125;<br>);<br><br><span class="hljs-comment">// 4. 导出实例</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> service;<br></code></pre></td></tr></table></figure>
<p><strong>这个文件做了什么？</strong></p>
<ul>
<li><strong>集中配置：</strong> <code>baseURL</code> 和 <code>timeout</code> 都被集中管理。</li>
<li><strong>环境变量：</strong> <code>baseURL</code> 从环境变量读取，这是现代前端项目的标准实践，可以轻松切换开发、测试和生产环境的 API 地址。</li>
<li><strong>统一认证：</strong> 请求拦截器自动处理 token。</li>
<li><strong>统一业务错误处理：</strong> 响应拦截器不仅处理 HTTP 错误，还处理后端返回的<strong>业务逻辑错误</strong>（例如 <code>code: 4001</code>, “用户名已存在”）。这是非常关键的一步，它让业务代码无需再关心这些通用的错误判断。</li>
<li><strong>数据简化：</strong> 成功的响应直接返回 <code>res.data</code>，进一步简化业务代码。</li>
</ul>
<hr>
<h3 id="2-API-模块化">2. API 模块化</h3>
<p>现在我们有了一个强大的、配置好的 <code>request</code> 实例。下一步是根据业务功能来组织我们的 API 请求。</p>
<p><strong>问题：</strong> 如果把所有 API 请求函数都写在一个文件里，当项目变大时，这个文件会变得臃肿不堪，难以维护。</p>
<p><strong>解决方案：按业务模块拆分 API 文件</strong></p>
<p>假设你的应用有“用户管理”和“商品管理”两大功能。我们就可以创建两个对应的 API 文件。</p>
<p><strong>目录结构示例：</strong></p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs nix">src<span class="hljs-symbol">/</span><br>├── api<span class="hljs-symbol">/</span><br>│   ├── index.js     (就是我们上面写的 request.js，有些人喜欢叫 index.js)<br>│   ├── user.js      (所有与用户相关的 API)<br>│   └── product.js   (所有与商品相关的 API)<br>└── views<span class="hljs-symbol">/</span><br>    ├── user<span class="hljs-symbol">/</span><br>    │   └── Profile.vue<br>    └── product<span class="hljs-symbol">/</span><br>        └── List.vue<br></code></pre></td></tr></table></figure>
<p><strong><code>src/api/user.js</code> 文件示例：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 导入我们封装好的 request 实例</span><br><span class="hljs-keyword">import</span> request <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/utils/request&#x27;</span>; <span class="hljs-comment">// @ 是 webpack/vite 的 alias，指向 src</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">data</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;/user/login&#x27;</span>,<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;post&#x27;</span>,<br>    data, <span class="hljs-comment">// ES6 简写，等同于 data: data</span><br>  &#125;);<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserInfo</span>(<span class="hljs-params">id</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">`/user/info/<span class="hljs-subst">$&#123;id&#125;</span>`</span>,<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;get&#x27;</span>,<br>  &#125;);<br>&#125;<br><br><span class="hljs-comment">// 使用更简洁的别名方法</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateUser</span>(<span class="hljs-params">id, data</span>) &#123;<br>  <span class="hljs-keyword">return</span> request.<span class="hljs-title function_">put</span>(<span class="hljs-string">`/user/<span class="hljs-subst">$&#123;id&#125;</span>`</span>, data);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong><code>src/api/product.js</code> 文件示例：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> request <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/utils/request&#x27;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getProductList</span>(<span class="hljs-params">params</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;/product/list&#x27;</span>,<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;get&#x27;</span>,<br>    params, <span class="hljs-comment">// GET 请求的参数放在 params 中</span><br>  &#125;);<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createProduct</span>(<span class="hljs-params">data</span>) &#123;<br>  <span class="hljs-keyword">return</span> request.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/product/create&#x27;</span>, data);<br>&#125;<br></code></pre></td></tr></table></figure>
<hr>
<h3 id="3-在业务组件中优雅地调用">3. 在业务组件中优雅地调用</h3>
<p>现在，在你的 Vue 或 React 组件中，调用 API 变得非常简单、清晰和直观。</p>
<p><strong><code>src/views/user/Profile.vue</code> 组件示例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div&gt;<br>    &lt;h1&gt;&#123;&#123; user.name &#125;&#125;&lt;/h1&gt;<br>    &lt;p&gt;&#123;&#123; user.email &#125;&#125;&lt;/p&gt;<br>  &lt;/div&gt;<br>&lt;/template&gt;<br><br>&lt;script setup&gt;<br>import &#123; ref, onMounted &#125; from &#x27;vue&#x27;;<br>// 1. 只导入需要的 API 函数<br>import &#123; getUserInfo &#125; from &#x27;@/api/user&#x27;;<br><br>const user = ref(&#123;&#125;);<br>const userId = 1; // 假设从路由参数或 store 中获取<br><br>onMounted(async () =&gt; &#123;<br>  try &#123;<br>    // 2. 调用 API，代码清晰，语义明确<br>    // 你完全不需要关心 token, baseURL, 错误处理等细节<br>    const userInfo = await getUserInfo(userId);<br>    user.value = userInfo;<br>  &#125; catch (error) &#123;<br>    // 捕获到的通常是拦截器处理后，仍然需要业务组件关心的错误<br>    console.error(&#x27;获取用户信息失败，可能是该用户不存在:&#x27;, error);<br>    // 在这里可以做一些 UI 反馈，比如显示 &quot;用户不存在&quot; 的提示<br>  &#125;<br>&#125;);<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>
<p><strong>这种架构的巨大优势：</strong></p>
<ol>
<li><strong>高内聚，低耦合：</strong> <code>request.js</code> 负责所有请求的通用逻辑。<code>user.js</code> 只负责用户相关的 API 定义。业务组件只负责调用 API 并处理 UI。职责清晰。</li>
<li><strong>可维护性极强：</strong> 如果后端修改了某个接口的 URL 或方法，你只需要去对应的 API 模块文件（如 <code>user.js</code>）修改一行代码即可，所有使用该 API 的组件都无需改动。</li>
<li><strong>可读性高：</strong> <code>getUserInfo(1)</code> 比 <code>request.get('/user/info/1')</code> 更能表达业务意图。</li>
<li><strong>易于团队协作：</strong> 团队成员可以并行开发不同的 API 模块和业务组件，互不干扰。</li>
</ol>
<hr>
<h3 id="第三阶段总结"><strong>第三阶段总结</strong></h3>
<p>你已经学会了如何像资深工程师一样组织项目的 API 层。这是从“能用”到“好用、好维护”的质变。</p>
<p><strong>核心思想：</strong></p>
<ol>
<li><strong>集中管理：</strong> 将 Axios 实例和拦截器封装在单一文件中。</li>
<li><strong>模块化：</strong> 按业务功能拆分 API 请求函数到不同文件中。</li>
<li><strong>面向业务：</strong> 导出的 API 函数名应体现业务意图，而不是 HTTP 方法。</li>
</ol>
<h2 id="高阶技巧与现代应用-持续学习">高阶技巧与现代应用 (持续学习)</h2>
<p>学习一些能让你从容应对复杂需求、并让代码更健壮的高级技巧。</p>
<p><strong>目标：</strong> 掌握请求取消、文件处理、并发请求以及与 TypeScript 的集成。这些是你在真实复杂项目中一定会遇到的场景。</p>
<hr>
<h3 id="1-取消请求-AbortController-现代标准">1. 取消请求 (<code>AbortController</code>) - 现代标准</h3>
<p><strong>为什么要取消请求？</strong><br>
想象一个场景：一个搜索框，用户每输入一个字就向后端发送请求。如果用户快速输入 “axios”，会依次发送 “a”, “ax”, “axi”, “axio”, “axios” 五个请求。实际上，我们只关心最后一个请求的结果。前面的请求不仅浪费服务器资源，还可能因为返回顺序错乱导致页面显示错误的数据（“axio” 的结果可能比 “axios” 的结果后返回）。</p>
<p><strong>解决方案：<code>AbortController</code></strong><br>
<code>AbortController</code> 是浏览器和 Node.js 的原生 API，用于创建一个可以中止一个或多个 Web 请求的信号。Axios v0.22.0 开始全面拥抱这个标准，并<strong>废弃了</strong>旧的 <code>CancelToken</code> API。<strong>请务必学习 <code>AbortController</code></strong>。</p>
<p><strong>如何使用：</strong></p>
<ol>
<li>创建一个 <code>AbortController</code> 实例。</li>
<li>将其 <code>signal</code> 传递给 Axios 请求的 <code>config</code>。</li>
<li>在需要取消时，调用 <code>controller.abort()</code>。</li>
</ol>
<p><strong>代码示例 (以 React/Vue 搜索框为例):</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; useState, useEffect, useRef &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>; <span class="hljs-comment">// React 示例</span><br><span class="hljs-keyword">import</span> &#123; searchApi &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/search&#x27;</span>;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">SearchComponent</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> [query, setQuery] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br>  <span class="hljs-keyword">const</span> [results, setResults] = <span class="hljs-title function_">useState</span>([]);<br>  <span class="hljs-comment">// 使用 useRef 存储 controller，以便在多次渲染间保持同个引用</span><br>  <span class="hljs-keyword">const</span> controllerRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);<br><br>  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">// 每次 query 变化时，如果 query 为空则不处理</span><br>    <span class="hljs-keyword">if</span> (!query) &#123;<br>      <span class="hljs-title function_">setResults</span>([]);<br>      <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 1. 如果存在上一个 controller，则中止上一次的请求</span><br>    <span class="hljs-keyword">if</span> (controllerRef.<span class="hljs-property">current</span>) &#123;<br>      controllerRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">abort</span>();<br>    &#125;<br><br>    <span class="hljs-comment">// 2. 创建一个新的 AbortController</span><br>    <span class="hljs-keyword">const</span> newController = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AbortController</span>();<br>    controllerRef.<span class="hljs-property">current</span> = newController;<br><br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">performSearch</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>      <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">searchApi</span>(query, &#123;<br>          <span class="hljs-comment">// 3. 将 signal 传递给请求</span><br>          <span class="hljs-attr">signal</span>: newController.<span class="hljs-property">signal</span><br>        &#125;);<br>        <span class="hljs-title function_">setResults</span>(data);<br>      &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>        <span class="hljs-comment">// 当请求被中止时，axios 会抛出一个名为 &#x27;CanceledError&#x27; 的错误</span><br>        <span class="hljs-keyword">if</span> (axios.<span class="hljs-title function_">isCancel</span>(error)) &#123;<br>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Request canceled:&#x27;</span>, error.<span class="hljs-property">message</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-comment">// 处理其他错误</span><br>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Search failed:&#x27;</span>, error);<br>        &#125;<br>      &#125;<br>    &#125;;<br><br>    <span class="hljs-comment">// 通常会结合 debounce 使用</span><br>    <span class="hljs-keyword">const</span> debounceTimer = <span class="hljs-built_in">setTimeout</span>(performSearch, <span class="hljs-number">300</span>);<br><br>    <span class="hljs-comment">// 清理函数，在组件卸载或 query 再次变化时执行</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearTimeout</span>(debounceTimer);<br><br>  &#125;, [query]);<br><br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;query&#125;</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> setQuery(e.target.value)&#125; /&gt;</span><br>    <span class="hljs-comment">// ...渲染 results</span><br>  );<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>关键点：</strong></p>
<ul>
<li>当 <code>controller.abort()</code> 被调用，与该 <code>signal</code> 关联的 Axios 请求会立即 <code>reject</code> Promise。</li>
<li>Axios 会抛出一个特殊的 <code>CanceledError</code>。你可以使用 <code>axios.isCancel(error)</code> 来判断错误是否由取消操作引起，从而避免向用户显示不必要的错误提示。</li>
</ul>
<hr>
<h3 id="2-与-TypeScript-结合-追求类型安全">2. 与 TypeScript 结合 - 追求类型安全</h3>
<p>使用 TypeScript 可以为你的 API 请求和响应数据提供强大的类型约束，极大减少运行时错误。</p>
<p><strong>实践：为 API 添加类型</strong></p>
<ol>
<li>
<p><strong>定义接口类型</strong><br>
创建一个 <code>types/api.ts</code> 文件或在 API 模块旁定义类型。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// src/api/types/user.ts</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">User</span> &#123;<br>  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;<br>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>  <span class="hljs-attr">username</span>: <span class="hljs-built_in">string</span>;<br>  <span class="hljs-attr">email</span>: <span class="hljs-built_in">string</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li>
<p><strong>在 API 函数中使用泛型</strong><br>
修改你的 API 模块文件（例如 <code>user.ts</code>）。Axios 的 <code>get</code>, <code>post</code> 等方法都支持泛型。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// src/api/user.ts</span><br><span class="hljs-keyword">import</span> request <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/utils/request&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> &#123; <span class="hljs-title class_">User</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./types/user&#x27;</span>; <span class="hljs-comment">// 导入类型</span><br><br><span class="hljs-comment">// 泛型 &lt;User&gt; 指定了 `request.get` 成功后返回的数据类型</span><br><span class="hljs-comment">// 因为我们的响应拦截器返回 res.data，所以这个类型对应的是 data 的类型</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserInfo</span>(<span class="hljs-params"><span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">User</span>&gt; &#123;<br>  <span class="hljs-keyword">return</span> request.<span class="hljs-property">get</span>&lt;<span class="hljs-title class_">User</span>&gt;(<span class="hljs-string">`/users/<span class="hljs-subst">$&#123;id&#125;</span>`</span>);<br>&#125;<br><br><span class="hljs-comment">// 对于 POST/PUT，可以为请求体和响应体都指定类型</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateUser</span>(<span class="hljs-params"><span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">data</span>: <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">User</span>&gt;</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">User</span>&gt; &#123;<br>  <span class="hljs-comment">// Partial&lt;User&gt; 表示 data 可以是 User 的部分属性</span><br>  <span class="hljs-keyword">return</span> request.<span class="hljs-property">put</span>&lt;<span class="hljs-title class_">User</span>&gt;(<span class="hljs-string">`/users/<span class="hljs-subst">$&#123;id&#125;</span>`</span>, data);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>注意：</strong> 这里的 <code>Promise&lt;User&gt;</code> 是因为我们的 <code>request</code> 实例的响应拦截器直接返回了 <code>res.data</code>。如果你的拦截器返回的是完整的 <code>response</code> 对象，那么类型应该是 <code>Promise&lt;AxiosResponse&lt;User&gt;&gt;</code>。</p>
</li>
<li>
<p><strong>在组件中享受类型提示和安全</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// src/views/Profile.vue</span><br><span class="hljs-keyword">import</span> &#123; ref, onMounted &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; getUserInfo &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/user&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> &#123; <span class="hljs-title class_">User</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/types/user&#x27;</span>;<br><br><span class="hljs-keyword">const</span> user = ref&lt;<span class="hljs-title class_">User</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);<br><br><span class="hljs-title function_">onMounted</span>(<span class="hljs-title function_">async</span> () =&gt; &#123;<br>  <span class="hljs-keyword">const</span> userInfo = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUserInfo</span>(<span class="hljs-number">1</span>);<br>  <span class="hljs-comment">// &#x27;userInfo&#x27; 在这里被 VSCode 自动推断为 User 类型</span><br>  <span class="hljs-comment">// 如果你试图访问 userInfo.age (一个不存在的属性)，TS 会立刻报错</span><br>  user.<span class="hljs-property">value</span> = userInfo;<br>&#125;);<br></code></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h3 id="3-其他实用功能">3. 其他实用功能</h3>
<h4 id="a-文件上传"><strong>a. 文件上传</strong></h4>
<p>使用 <code>FormData</code> 对象，Axios 会自动设置 <code>Content-Type</code> 为 <code>multipart/form-data</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// HTML: &lt;input type=&quot;file&quot; id=&quot;fileInput&quot; /&gt;</span><br><span class="hljs-keyword">const</span> fileInput = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;fileInput&#x27;</span>);<br><span class="hljs-keyword">const</span> file = fileInput.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>];<br><br><span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>();<br>formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">&#x27;file&#x27;</span>, file); <span class="hljs-comment">// &#x27;file&#x27; 是后端接收此文件的字段名</span><br>formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">&#x27;userId&#x27;</span>, <span class="hljs-string">&#x27;123&#x27;</span>); <span class="hljs-comment">// 也可以附加其他数据</span><br><br><span class="hljs-comment">// 在 api/file.js 中</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">uploadFile</span>(<span class="hljs-params">data</span>) &#123;<br>  <span class="hljs-keyword">return</span> request.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/upload&#x27;</span>, data, &#123;<br>    <span class="hljs-comment">// 覆盖默认的 JSON header</span><br>    <span class="hljs-attr">headers</span>: &#123;<br>      <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;multipart/form-data&#x27;</span>,<br>    &#125;<br>  &#125;);<br>&#125;<br><br><span class="hljs-comment">// 调用</span><br><span class="hljs-keyword">await</span> <span class="hljs-title function_">uploadFile</span>(formData);<br></code></pre></td></tr></table></figure>
<h4 id="b-进度监控"><strong>b. 进度监控</strong></h4>
<p>Axios 提供了 <code>onUploadProgress</code> 和 <code>onDownloadProgress</code> 回调函数来监控进度。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">uploadWithProgress</span>(<span class="hljs-params">data, onProgress</span>) &#123;<br>  <span class="hljs-keyword">return</span> request.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/upload&#x27;</span>, data, &#123;<br>    <span class="hljs-attr">headers</span>: &#123; <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;multipart/form-data&#x27;</span> &#125;,<br>    <span class="hljs-attr">onUploadProgress</span>: <span class="hljs-function">(<span class="hljs-params">progressEvent</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">const</span> percentCompleted = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>((progressEvent.<span class="hljs-property">loaded</span> * <span class="hljs-number">100</span>) / progressEvent.<span class="hljs-property">total</span>);<br>      <span class="hljs-title function_">onProgress</span>(percentCompleted); <span class="hljs-comment">// 调用外部传入的回调函数更新 UI</span><br>    &#125;,<br>  &#125;);<br>&#125;<br><br><span class="hljs-comment">// 在组件中</span><br><span class="hljs-keyword">await</span> <span class="hljs-title function_">uploadWithProgress</span>(formData, <span class="hljs-function">(<span class="hljs-params">percent</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`上传进度: <span class="hljs-subst">$&#123;percent&#125;</span>%`</span>);<br>  <span class="hljs-comment">// 更新进度条 UI</span><br>&#125;);<br></code></pre></td></tr></table></figure>
<h4 id="c-并发请求-axios-all-和-axios-spread"><strong>c. 并发请求 (<code>axios.all</code> 和 <code>axios.spread</code>)</strong></h4>
<p>当你需要同时发起多个请求，并在所有请求都完成后再进行操作时，可以使用 <code>axios.all</code>。它本质上是 <code>Promise.all</code> 的一个语法糖。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span>; <span class="hljs-comment">// 这里直接用全局 axios 举例，实践中用你的实例</span><br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getInitialData</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">const</span> [userResponse, permissionsResponse] = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">all</span>([<br>      request.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/user/1&#x27;</span>),<br>      request.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/user/1/permissions&#x27;</span>)<br>    ]);<br><br>    <span class="hljs-comment">// 使用解构来处理结果</span><br>    <span class="hljs-keyword">const</span> userData = userResponse; <span class="hljs-comment">// 假设拦截器已处理 .data</span><br>    <span class="hljs-keyword">const</span> permissionsData = permissionsResponse;<br><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;User:&#x27;</span>, userData);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Permissions:&#x27;</span>, permissionsData);<br><br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Failed to fetch initial data:&#x27;</span>, error);<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// 旧的 axios.spread 写法（现在不推荐，用数组解构更现代）</span><br><span class="hljs-comment">// axios.all([...]).then(axios.spread((user, perms) =&gt; &#123; ... &#125;));</span><br></code></pre></td></tr></table></figure>
<p><strong>现代实践：</strong> 直接使用 <code>Promise.all</code>，它更通用，功能完全一样。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getInitialDataModern</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">const</span> [userData, permissionsData] = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([<br>      request.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/user/1&#x27;</span>),<br>      request.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/user/1/permissions&#x27;</span>)<br>    ]);<br><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;User:&#x27;</span>, userData);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Permissions:&#x27;</span>, permissionsData);<br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Failed to fetch initial data:&#x27;</span>, error);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<hr>
<h3 id="第四阶段与学习规划总结"><strong>第四阶段与学习规划总结</strong></h3>
<p>完成了从 <code>fetch</code> 到 Axios 的全部学习路径。回顾：</p>
<ul>
<li><strong>阶段一：</strong> 你学会了 Axios 的基本用法，并体会到它相比 <code>fetch</code> 在数据处理和错误处理上的便利性。</li>
<li><strong>阶段二：</strong> 你掌握了 Axios 的灵魂——实例创建和拦截器，学会了如何将通用逻辑与业务代码解耦。</li>
<li><strong>阶段三：</strong> 你学会了如何进行企业级的 API 层封装和模块化，让项目结构清晰、可维护。</li>
<li><strong>阶段四：</strong> 你掌握了请求取消、TS 集成、文件处理等高级技巧，能从容应对各种复杂场景。</li>
</ul>
<p><strong>下一步是什么？</strong></p>
<ul>
<li><strong>持续实践：</strong> 在你的下一个项目中，完整地实践这套架构。</li>
<li><strong>深入探索：</strong> 当你遇到更奇特的需求时（例如自定义适配器、序列化参数等），查阅 Axios 的官方文档，你会发现它提供了非常多深入的配置项。</li>
<li><strong>保持更新：</strong> 关注 Axios 在 GitHub 上的发布日志，了解新的特性和最佳实践的变化（比如从 <code>CancelToken</code> 到 <code>AbortController</code> 的迁移）。</li>
</ul>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/JavaScript/" class="category-chain-item">JavaScript</a>
  
  
    <span>></span>
    
  <a href="/categories/JavaScript/Framework-and-Library/" class="category-chain-item">Framework and Library</a>
  
  
    <span>></span>
    
  <a href="/categories/JavaScript/Framework-and-Library/Axios/" class="category-chain-item">Axios</a>
  
  

  

  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Fetch -&gt; Axios</div>
      <div>http://example.com/2025/05/24/JavaScript/Framework and Library/Axios/Axios/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Han Di</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年5月24日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/05/24/Java/Framework/Spring%20Boot/Exception/%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BC%82%E5%B8%B8/" title="自定义运行时异常">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">自定义运行时异常</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/05/24/JavaScript/Framework%20and%20Library/OpenApi/openapi-typescript-codegen/" title="openapi-typescript-codegen">
                        <span class="hidden-mobile">openapi-typescript-codegen</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  <div>
    <span id="timeDate">正在载入天数...</span>
    <span id="times">载入时分秒...</span>
    <script>
    var now = new Date();
    function createtime(){
      var grt= new Date("08/17/2020 00:00:00");
      now.setTime(now.getTime()+250);
      days = (now - grt ) / 1000 / 60 / 60 / 24;
      dnum = Math.floor(days);
      hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
      hnum = Math.floor(hours);
      if(String(hnum).length ==1 ){
          hnum = "0" + hnum;
      }
      minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
      mnum = Math.floor(minutes);
      if(String(mnum).length ==1 ){
                mnum = "0" + mnum;
      }
      seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
      snum = Math.round(seconds);
      if(String(snum).length ==1 ){
                snum = "0" + snum;
      }
      document.getElementById("timeDate").innerHTML = "已持续航行&nbsp"+dnum+"&nbsp天";  
      document.getElementById("times").innerHTML = hnum + "&nbsp时&nbsp" + mnum + "&nbsp分&nbsp" + snum + "&nbsp秒";
    }
    setInterval("createtime()",250);
    </script>
  </div>

  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
    <!-- 备案信息 ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      京ICP证123456号
    </a>
  </span>
  
    
      <span>
        <a
          href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=12345678"
          rel="nofollow noopener"
          class="beian-police"
          target="_blank"
        >
          
            <span style="visibility: hidden; width: 0">|</span>
            <img src="/img/police_beian.png" srcset="/img/loading.gif" lazyload alt="police-icon"/>
          
          <span>京公网安备12345678号</span>
        </a>
      </span>
    
  
</div>

  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  
<script src="/js/scrollAnimation.js"></script>
<script src="/js/DynamicLine.min.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<!-- hexo injector body_end start --><script src="/js/backgroundize.js"></script><!-- hexo injector body_end end --></body>
</html>
